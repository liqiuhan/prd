# 指标权限配置工具需求文档

## 1. 系统概述

指标权限配置工具是一个用于配置和管理不同角色对业务指标访问权限的Web应用。该系统允许用户根据角色包选择多层级指标结构，并通过可视化方式配置指标权限，最终保存到权限管理系统中。本工具为数据管理人员提供了一种直观、高效的方式来管理指标访问控制。

## 2. 功能需求

### 2.1 页面布局与导航

#### 2.1.1 步骤导航
- 使用清晰的步骤指示器，显示当前所处步骤
- 包含两个主要步骤：指标选择和权限预览/配置
- 步骤间切换的前进后退控制
- 完成状态标记（已完成、当前、未完成）

#### 2.1.2 用户提示区域
- 在顶部显示用户操作指引
- 突出显示当前操作的角色包
- 提供重置选择的快捷按钮

### 2.2 指标选择功能（步骤1）

#### 2.2.1 角色包选择
- 在顶部显示当前选择的角色包信息
- 展示该角色包的描述信息

#### 2.2.2 多层级指标筛选器
- 提供5层级的指标选择界面：
  - 第一层级：业务域
  - 第二层级：业务线
  - 第三层级：指标分类
  - 第四层级：指标类型
  - 第五层级：指标名称
- 支持在每个层级进行多选
- 每个层级支持全选功能
- 选择上层选项后，显示对应的下层选项
- 提供清空所有选择的功能

#### 2.2.3 思维导图可视化
- 将选择的指标以思维导图形式直观展示
- 支持删除已选择的指标路径
- 树状结构清晰展示层级关系
- 提供节点间曲线连接，美化视觉效果

### 2.3 权限预览与配置（步骤2）

#### 2.3.1 权限状态预览
- 显示已选指标的权限状态
- 区分有权限和无权限的指标
- 使用不同颜色或标记表示权限状态

#### 2.3.2 权限调整功能
- 支持在预览界面上直接调整权限设置
- 对无权限指标提供申请权限选项
- 对有权限指标提供移除权限选项

#### 2.3.3 权限保存功能
- 提供保存按钮，将配置的权限保存到系统
- 保存成功后提供明确的反馈
- 完成后自动重置页面状态

### 2.4 默认权限加载功能

#### 2.4.1 角色权限自动加载
- 选择角色包后自动加载该角色默认权限
- 预选相应的指标选项
- 在思维导图中直观展示已有权限

## 3. 用户界面需求

### 3.1 整体设计风格
- 简洁现代的卡片式设计
- 白色背景配合蓝色主题色
- 响应式设计，适配不同屏幕尺寸

### 3.2 组件样式

#### 3.2.1 按钮设计
- 主要操作按钮：蓝色背景，白色文字
- 次要操作按钮：白色背景，蓝色边框和文字
- 危险操作按钮：红色
- 成功操作按钮：绿色
- 所有按钮需要有悬停效果

#### 3.2.2 复选框组
- 层级分明的复选框列表
- 全选功能在每组顶部
- 选中状态有明显视觉标识
- 鼠标悬停效果

#### 3.2.3 思维导图视觉设计
- 节点使用圆角矩形，有边框和阴影
- 连接线使用曲线，平滑过渡
- 节点悬停效果：轻微上浮和阴影增强
- 删除按钮内嵌于节点
- 权限状态使用不同颜色区分：
  - 有权限节点：正常颜色
  - 无权限节点：灰色或带特殊标记

### 3.3 步骤导航设计
- 使用圆形数字标识每个步骤
- 已完成步骤使用绿色标记
- 当前步骤使用蓝色标记
- 步骤间连线表示进度

### 3.4 用户提示设计
- 使用带边框的提示框
- 重要信息以高亮或粗体显示
- 简洁清晰的指引语言

## 4. 交互需求

### 4.1 多层级联动
- 选择上级项目后，自动显示和更新下级选项
- 取消选择上级项目时，自动清空和隐藏对应的下级选项
- 提供流畅的层级切换体验

### 4.2 思维导图交互
- 点击节点上的删除按钮可移除该路径
- 节点有悬停效果
- 思维导图实时更新以反映选择变化

### 4.3 权限管理交互
- 点击权限状态图标可切换权限状态
- 权限变更有即时的视觉反馈
- 权限调整需要确认机制防止误操作

## 5. 技术要求

### 5.1 前端技术
- 使用HTML5、CSS3和JavaScript实现
- 使用D3.js库实现思维导图可视化
- 不依赖其他前端框架
- 使用现代ES6+语法

### 5.2 性能要求
- 层级选择实时响应，无明显延迟
- 思维导图渲染流畅，支持大量节点
- 页面切换无闪烁
- 权限加载和保存操作响应及时

### 5.3 数据处理
- 支持复杂的多层级数据结构
- 高效处理指标路径的增加和删除
- 角色权限数据的加载和保存

## 6. 用户体验优化

### 6.1 操作引导
- 每个步骤有清晰的操作提示
- 强调重要操作和信息
- 避免使用专业术语，采用用户友好的语言

### 6.2 错误处理
- 表单验证提供即时反馈
- 操作错误有友好提示
- 防止数据丢失的保护机制

### 6.3 视觉反馈
- 所有可交互元素有明确的状态变化
- 操作成功/失败有明确提示
- 加载过程有加载指示器 