# 新指标关系配置系统需求文档

## 1. 系统概述

新指标关系配置系统是一个用于创建和管理针对业务指标的标准化查询问题的Web应用。该系统通过引导用户完成一系列结构化的步骤，帮助他们定义指标查询的各个方面，包括选择指标、确定查询维度、设置时间范围等。最终形成一套能够被系统解析和执行的查询指令，为用户提供快速获取业务指标数据的能力。

## 2. 功能需求

### 2.1 多步骤引导配置流程

系统应采用分步骤引导式的配置流程，将复杂的问题定义过程拆分为以下八个清晰的步骤：

#### 2.1.1 步骤1：选择指标
- 提供指标搜索功能，支持模糊匹配
- 显示已选择的指标列表，支持删除操作
- 至少需要选择一个指标才能进入下一步

#### 2.1.2 步骤2：选择对象层级
- 提供多级业务对象层级选择，如全国、区域、城市、部门等
- 支持多选功能，以便用户可以同时查看不同层级的数据
- 至少需要选择一个对象层级才能进入下一步

#### 2.1.3 步骤3：设置时间范围
- 提供预定义的时间范围选项，如今日、本周、本月、上季度等
- 支持自定义时间范围，可选择起始日期和结束日期
- 至少需要设置一个时间范围才能进入下一步

#### 2.1.4 步骤4：限制约束条件
- 提供可选的约束维度，如业务类型、客户类型、房源类型等
- 根据选择的维度动态显示相应的约束值选项
- 支持为同一查询设置多个约束条件
- 此步骤为可选步骤，无需强制设置约束条件

#### 2.1.5 步骤5：选择分组
- 提供不同的分组方式选项，如按时间分组、按区域分组等
- 支持多选功能，可以同时按多种维度进行分组
- 至少需要选择一种分组方式才能进入下一步

#### 2.1.6 步骤6：排序方式
- 提供多种排序选项，如指标值升序、降序、变化率等
- 支持选择多个排序条件，并按优先级应用
- 至少需要选择一种排序方式才能进入下一步

#### 2.1.7 步骤7：结果筛选
- 提供对结果进行筛选的选项，如仅显示前N项、仅显示增长/下降项等
- 支持多个筛选条件组合
- 至少需要选择一种筛选方式才能进入下一步

#### 2.1.8 步骤8：问题预览
- 展示根据前七个步骤配置生成的标准化问题
- 提供可视化的问题卡片，显示问题的标题、内容和元数据
- 支持保存配置的功能

### 2.2 导航与步骤切换

#### 2.2.1 垂直步骤导航栏
- 在页面左侧提供清晰的步骤导航，显示所有八个步骤
- 当前步骤高亮显示，已完成步骤标记为完成状态
- 支持点击已完成步骤直接跳转，但不允许跳至未完成的步骤

#### 2.2.2 步骤间导航控制
- 每个步骤页面底部提供"下一步"按钮
- 当前步骤未完成必要选择时，下一步按钮应处于禁用状态
- 提供上一步功能，允许用户返回修改之前的选择

### 2.3 数据输入与选择

#### 2.3.1 搜索与选择组件
- 指标选择支持搜索筛选，并显示匹配结果
- 已选项以标签形式显示，支持删除操作

#### 2.3.2 复选框组
- 对于多选项的步骤，使用复选框组展示可选项
- 复选框组应有清晰的布局，便于用户快速浏览和选择

#### 2.3.3 动态表单元素
- 基于用户的选择，动态显示或隐藏相关的表单元素
- 例如，选择约束维度后，显示该维度下的具体约束值选项

### 2.4 问题预览与保存

#### 2.4.1 问题卡片展示
- 在最后一步以卡片形式展示配置的问题
- 卡片应包含问题标题、问题内容和相关元数据

#### 2.4.2 保存功能
- 提供保存按钮，将配置的问题保存到系统
- 保存成功后提供明确的成功反馈

## 3. 用户界面需求

### 3.1 整体设计风格

#### 3.1.1 现代卡片式设计
- 采用简洁、现代的卡片式设计风格
- 主要内容区域使用白色背景，配合蓝色主题色
- 圆角元素和适度的阴影提升视觉层次

#### 3.1.2 响应式布局
- 设计应支持不同屏幕尺寸，特别是在平板和桌面设备上有良好表现
- 在小屏幕设备上，步骤导航可转为水平布局

### 3.2 组件设计

#### 3.2.1 步骤导航设计
- 垂直排列的步骤项，包含步骤编号和名称
- 当前步骤使用蓝色高亮，已完成步骤使用绿色标记
- 步骤间通过垂直线条连接，表示流程的连续性

#### 3.2.2 表单元素设计
- 输入框、下拉菜单等表单元素使用统一的样式
- 表单控件具有适当的尺寸和间距，提高操作便利性
- 焦点状态有明确的视觉反馈，如边框颜色变化

#### 3.2.3 按钮设计
- 主要操作按钮使用蓝色背景，次要按钮使用白色背景配合边框
- 禁用状态的按钮使用灰色，并取消悬停效果
- 按钮有统一的尺寸和内边距，确保点击区域足够大

#### 3.2.4 标签与卡片设计
- 已选项使用标签形式展示，带有删除选项
- 预览问题使用卡片形式，有适当的阴影和悬停效果

### 3.3 交互反馈

#### 3.3.1 表单验证反馈
- 未完成必填项时，应提供明确的视觉提示
- 表单验证错误应有具体的错误信息

#### 3.3.2 加载状态反馈
- 数据加载过程中显示加载动画
- 保存操作过程中按钮应显示加载状态

#### 3.3.3 操作成功反馈
- 保存成功后显示成功消息
- 步骤完成后自动导航至下一步

## 4. 技术要求

### 4.1 前端技术
- 使用HTML5、CSS3和JavaScript实现
- 不依赖第三方UI框架，保持界面轻量级
- 使用现代CSS特性如Flexbox和Grid进行布局

### 4.2 性能要求
- 页面加载速度快，初始加载时间不超过3秒
- 步骤间切换流畅，无明显延迟
- 表单操作响应迅速，反馈及时

### 4.3 兼容性要求
- 支持现代浏览器（Chrome、Firefox、Edge等）
- 支持桌面和平板设备的不同屏幕尺寸

## 5. 数据处理

### 5.1 表单数据管理
- 在步骤间切换时保留已填写的表单数据
- 支持在任何步骤修改之前的选择，并相应更新后续依赖项

### 5.2 数据验证
- 对必填项进行验证，确保配置的完整性
- 提供清晰的错误提示，指导用户修正错误

### 5.3 数据持久化
- 支持将配置的问题保存到服务器
- 支持读取已有配置进行编辑

## 6. 用户体验优化

### 6.1 引导提示
- 在关键步骤提供简洁的操作提示
- 对复杂选项提供说明文本

### 6.2 快捷操作
- 支持键盘导航，如使用Enter确认，Esc取消
- 提供一键清空等便捷操作

### 6.3 状态保持
- 浏览器刷新后能够恢复之前的配置状态
- 提供自动保存功能，防止意外操作导致数据丢失 