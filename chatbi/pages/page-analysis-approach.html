<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatBI - äº§å“èƒ½åŠ›é…ç½®</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
}

body {
  min-height: 100vh;
  background-color: #f9f9fc;
  color: #333;
}

.main-content {
  padding: 30px;
  background-color: #fff;
  border-radius: 8px;
  margin: 20px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.03);
  overflow-y: auto;
}

.content-page {
  display: none;
}

.content-page.active {
  display: block;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.page-title {
  font-size: 22px;
  font-weight: 500;
  color: #333;
}

.create-button {
  background-color: #4e7eff;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  font-size: 14px;
  transition: background-color 0.2s;
}

.create-button:hover {
  background-color: #3a6ae6;
}

.create-button i {
  margin-right: 6px;
}

.tabs {
  display: flex;
  border-bottom: 1px solid #eee;
  margin-bottom: 24px;
}

.tab {
  padding: 12px 24px;
  cursor: pointer;
  color: #666;
  font-size: 14px;
  position: relative;
}

.tab.active {
  color: #4e7eff;
}

.tab.active::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 0;
  width: 100%;
  height: 2px;
  background-color: #4e7eff;
}

.assistant-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
}

.assistant-card {
  background-color: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  border: 1px solid #eee;
  transition: transform 0.2s, box-shadow 0.2s;
}

.assistant-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.assistant-avatar {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background-color: #f0f5ff;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 12px;
  overflow: hidden;
}

.assistant-avatar svg {
  width: 50px;
  height: 50px;
}

.assistant-name {
  font-size: 16px;
  font-weight: 500;
  color: #333;
  margin-bottom: 16px;
  text-align: center;
}

.assistant-actions {
  display: flex;
  justify-content: center;
  gap: 8px;
  width: 100%;
}

.action-button {
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px;
  border-radius: 4px;
  color: #666;
  transition: background-color 0.2s;
}

.action-button:hover {
  background-color: #f5f6fa;
  color: #4e7eff;
}

.empty-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: #999;
  font-size: 16px;
  padding: 100px 0;
}

.empty-placeholder i {
  font-size: 60px;
  margin-bottom: 20px;
  color: #ccc;
}

/* åˆ†ææ€è·¯é¡µé¢æ ·å¼ */
#analysisPathPage .container {
  width: 100%;
  max-width: 1280px;
  margin: 0 auto;
  padding: 20px;
}

#analysisPathPage header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 15px;
  border-bottom: 1px solid #eee;
}

#analysisPathPage h1, #analysisPathPage h2, #analysisPathPage h3 {
  color: #333;
}

#analysisPathPage .button {
  padding: 10px 15px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: bold;
  transition: background-color 0.3s;
}

#analysisPathPage .button-primary {
  background-color: #3498db;
  color: white;
}

#analysisPathPage .button-primary:hover {
  background-color: #2980b9;
}

#analysisPathPage .button-success {
  background-color: #27ae60;
  color: white;
}

#analysisPathPage .button-success:hover {
  background-color: #219653;
}

#analysisPathPage .button-danger {
  background-color: #e74c3c;
  color: white;
}

#analysisPathPage .button-danger:hover {
  background-color: #c0392b;
}

#analysisPathPage .button-preview {
  background-color: #9b59b6;
  color: white;
}

#analysisPathPage .button-preview:hover {
  background-color: #8e44ad;
  color: white;
}

/* ç®¡ç†é¡µé¢æ ·å¼ */
#analysisPathPage .tab-container {
  margin-bottom: 20px;
}

#analysisPathPage .tabs {
  display: flex;
  border-bottom: 1px solid #eee;
  margin-bottom: 15px;
}

#analysisPathPage .tab {
  padding: 10px 20px;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  white-space: nowrap;
}

#analysisPathPage .tab.active {
  border-bottom: 2px solid #3498db;
  color: #3498db;
  font-weight: bold;
}

#analysisPathPage .tab-content {
  display: none;
}

#analysisPathPage .tab-content.active {
  display: block;
}

#analysisPathPage .search-bar {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 15px;
}

#analysisPathPage .analysis-path-list {
  margin-top: 20px;
}

#analysisPathPage .analysis-path-item {
  padding: 15px;
  background-color: white;
  border-radius: 4px;
  margin-bottom: 15px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
  transition: transform 0.2s, box-shadow 0.2s;
}

#analysisPathPage .analysis-path-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

#analysisPathPage .analysis-path-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

#analysisPathPage .analysis-path-title {
  font-weight: bold;
  font-size: 18px;
}

#analysisPathPage .analysis-path-actions {
  display: flex;
  gap: 10px;
}

#analysisPathPage .tag {
  display: inline-block;
  padding: 3px 8px;
  background-color: #e1f5fe;
  color: #0288d1;
  border-radius: 3px;
  font-size: 12px;
  margin-right: 5px;
  margin-bottom: 5px;
}

#analysisPathPage .tag-object {
  background-color: #e8f5e9;
  color: #388e3c;
}

#analysisPathPage .tag-module {
  background-color: #e3f2fd;
  color: #1565c0;
}

#analysisPathPage .tag-knowledge {
  background-color: #fff8e1;
  color: #f57f17;
}

#analysisPathPage .tag-strategy {
  background-color: #f1f8e9;
  color: #558b2f;
}

#analysisPathPage .analysis-path-components {
  margin-top: 10px;
  padding: 10px;
  background-color: #f9f9f9;
  border-radius: 4px;
}

#analysisPathPage .component-section {
  margin-bottom: 10px;
}

#analysisPathPage .component-title {
  font-weight: bold;
  color: #95a5a6;
  margin-bottom: 5px;
  font-size: 14px;
}

#analysisPathPage .component-items {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

#analysisPathPage .component-item {
  background-color: white;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 3px 8px;
  font-size: 13px;
}

/* åˆ›å»ºé¡µé¢æ ·å¼ */
#analysisPathPage .page {
  display: none;
}

#analysisPathPage .page.active {
  display: block;
}

#analysisPathPage .breadcrumb {
  display: flex;
  margin-bottom: 20px;
  font-size: 14px;
  color: #95a5a6;
}

#analysisPathPage .breadcrumb a {
  color: #3498db;
  text-decoration: none;
}

#analysisPathPage .breadcrumb a:hover {
  text-decoration: underline;
}

#analysisPathPage .breadcrumb .separator {
  margin: 0 10px;
}

#analysisPathPage .form-group {
  margin-bottom: 20px;
}

#analysisPathPage label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

#analysisPathPage input, #analysisPathPage textarea, #analysisPathPage select {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
}

#analysisPathPage textarea {
  min-height: 80px;
  resize: vertical;
}

#analysisPathPage .card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 15px;
  margin-bottom: 30px;
}

#analysisPathPage .card {
  background-color: white;
  border-radius: 4px;
  padding: 15px;
  border: 1px solid #eee;
  cursor: pointer;
  transition: all 0.3s ease;
}

#analysisPathPage .card:hover {
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  transform: translateY(-2px);
}

#analysisPathPage .card.selected {
  border-color: #3498db;
  background-color: rgba(52, 152, 219, 0.05);
}

#analysisPathPage .card-title {
  font-weight: bold;
  margin-bottom: 5px;
  color: #333;
}

#analysisPathPage .card-description {
  font-size: 14px;
  color: #95a5a6;
}

#analysisPathPage .section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid #eee;
  transition: all 0.3s ease;
}

#analysisPathPage .section-header.highlight {
  background-color: rgba(52, 152, 219, 0.1);
  padding: 10px;
  border-radius: 4px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

#analysisPathPage .section-title {
  display: flex;
  align-items: center;
}

#analysisPathPage .section-number {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  background-color: #3498db;
  color: white;
  border-radius: 50%;
  margin-right: 10px;
  font-weight: bold;
}

/* æ›´æ–°åçš„é€‰ä¸­é¡¹ç›®æ ·å¼ï¼Œæ·»åŠ ç¼–å·å’Œç®­å¤´ */
#analysisPathPage .selected-items {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
  margin-top: 15px;
}

#analysisPathPage .selected-item {
  background-color: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  padding: 5px 10px 5px 5px;
  display: flex;
  align-items: center;
  font-size: 14px;
}

#analysisPathPage .selected-item .item-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  background-color: #3498db;
  color: white;
  border-radius: 50%;
  margin-right: 8px;
  font-size: 12px;
  font-weight: bold;
}

#analysisPathPage .selected-item .remove {
  margin-left: 8px;
  color: #e74c3c;
  cursor: pointer;
}

#analysisPathPage .item-arrow {
  color: #95a5a6;
  font-size: 16px;
  display: flex;
  align-items: center;
}

#analysisPathPage .object-chip {
  display: inline-block;
  padding: 5px 10px;
  background-color: #eee;
  border-radius: 20px;
  margin-right: 10px;
  margin-bottom: 10px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.2s;
}

#analysisPathPage .object-chip:hover {
  background-color: #e0e0e0;
}

#analysisPathPage .object-chip.selected {
  background-color: #27ae60;
  color: white;
}

#analysisPathPage .action-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 30px;
  padding-top: 20px;
  border-top: 1px solid #eee;
}

#analysisPathPage .section-container {
  background-color: white;
  border-radius: 4px;
  padding: 20px;
  margin-bottom: 30px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
  scroll-margin-top: 100px; /* æ»šåŠ¨åˆ°æ­¤å…ƒç´ æ—¶çš„åç§»é‡ï¼Œç•™å‡ºè¶³å¤Ÿçš„ç©ºé—´ç»™ç²˜æ€§ç­‰å¼ */
}

#analysisPathPage .dataset-strategy-container {
  margin-top: 20px;
  border: 1px solid #eee;
  border-radius: 4px;
  padding: 15px;
  margin-bottom: 20px;
}

#analysisPathPage .dataset-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px dashed #eee;
}

#analysisPathPage .dataset-title {
  font-weight: bold;
  color: #333;
}

#analysisPathPage .strategy-section {
  margin-bottom: 20px;
}

#analysisPathPage .strategy-section h4 {
  margin-bottom: 10px;
  color: #95a5a6;
}

#analysisPathPage .no-datasets-selected {
  padding: 30px;
  text-align: center;
  color: #95a5a6;
  font-style: italic;
  background-color: #f5f5f5;
  border-radius: 4px;
}

#analysisPathPage .two-columns {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

/* å¥‡å¦™ç­‰å¼æ ·å¼ - æ”¹è¿›ç‰ˆ */
#analysisPathPage .equation-container {
  display: flex;
  justify-content: center;
  align-items: center; /* ä¿®æ”¹ä¸ºcenterä½¿æ‰€æœ‰å…ƒç´ å‚ç›´å±…ä¸­ */
  margin: 30px 0;
  padding: 20px;
  background-color: #f7f9fa;
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  min-height: 120px; /* è®¾ç½®æœ€å°é«˜åº¦ */
  flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */
  transition: all 0.3s ease;
}

/* æ‚¬æµ®ç­‰å¼å®¹å™¨æ ·å¼ */
#analysisPathPage .equation-container.sticky {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  margin: 0;
  padding: 12px 20px;
  border-radius: 0;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  min-height: auto;
  height: auto;
}

/* æ·»åŠ å†…å®¹å®¹å™¨ï¼Œç¡®ä¿å†…å®¹å±…ä¸­ä¸”å®½åº¦ä¿æŒä¸€è‡´ */
#analysisPathPage .equation-content {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  max-width: 1240px; /* å’Œç™½è‰²ä¸»ä½“å†…å®¹åŒºåŸŸç›¸åŒçš„å®½åº¦ */
  margin: 0 auto;
  padding: 0 20px;
}

#analysisPathPage .equation-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding: 15px;
  min-width: 150px; /* å¢åŠ æœ€å°å®½åº¦ */
  border-radius: 4px;
  transition: all 0.3s ease;
  cursor: pointer;
  margin: 0 5px; /* ç§»é™¤åº•éƒ¨margin */
  text-align: center;
  position: relative;
}

/* å¸é¡¶çŠ¶æ€ä¸‹ç®€åŒ–çš„ç­‰å¼æ ·å¼ */
#analysisPathPage .sticky .equation-item {
  padding: 8px 12px;
  min-width: auto;
  height: auto;
}

#analysisPathPage .equation-item:hover {
  background-color: rgba(52, 152, 219, 0.1);
}

#analysisPathPage .equation-item.active {
  background-color: rgba(52, 152, 219, 0.2);
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
}

#analysisPathPage .equation-item .icon {
  font-size: 24px;
  margin-bottom: 10px;
  color: #3498db;
}

/* å¸é¡¶çŠ¶æ€ä¸‹éšè—å›¾æ ‡ */
#analysisPathPage .sticky .equation-item .icon {
  display: none;
}

#analysisPathPage .equation-item .text {
  font-weight: bold;
  color: #333;
  font-size: 14px;
  margin-bottom: 10px; /* å¢åŠ æ–‡å­—ä¸æ ‡ç­¾çš„é—´è· */
}

/* å¸é¡¶çŠ¶æ€ä¸‹è°ƒæ•´æ–‡å­—æ ·å¼ */
#analysisPathPage .sticky .equation-item .text {
  margin-bottom: 5px;
  font-size: 13px;
}

#analysisPathPage .equation-equals, #analysisPathPage .equation-plus {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  font-weight: bold;
  margin: 0 15px;
  color: #95a5a6;
  align-self: center; /* å‚ç›´å±…ä¸­ */
  height: 40px; /* å›ºå®šé«˜åº¦ */
}

/* å¸é¡¶çŠ¶æ€ä¸‹è°ƒæ•´ç¬¦å·æ ·å¼ */
#analysisPathPage .sticky .equation-equals, 
#analysisPathPage .sticky .equation-plus {
  font-size: 18px;
  height: auto;
  margin: 0 8px;
}

#analysisPathPage .equation-selected-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  padding: 5px;
  gap: 5px;
  width: 100%; /* è®¾ç½®å®½åº¦ä¸º100%ä»¥ä¾¿æ ‡ç­¾ä½äºä¸‹æ–¹ */
}

/* å¸é¡¶çŠ¶æ€ä¸‹è°ƒæ•´æ ‡ç­¾å®¹å™¨æ ·å¼ */
#analysisPathPage .sticky .equation-selected-tags {
  padding: 0;
}

#analysisPathPage .equation-tag {
  display: inline-block;
  padding: 3px 6px;
  border-radius: 3px;
  font-size: 11px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

/* å¸é¡¶çŠ¶æ€ä¸‹è°ƒæ•´æ ‡ç­¾æ ·å¼ */
#analysisPathPage .sticky .equation-tag {
  font-size: 10px;
  padding: 2px 5px;
}

#analysisPathPage .equation-tag-module {
  background-color: #e3f2fd;
  color: #1565c0;
}

#analysisPathPage .equation-tag-knowledge {
  background-color: #fff8e1;
  color: #f57f17;
}

#analysisPathPage .equation-tag-strategy {
  background-color: #f1f8e9;
  color: #558b2f;
}

/* åˆ—è¡¨é¡µçš„æ€ç»´å¯¼å›¾æ ·å¼ - ä¿®æ”¹ååªæ˜¾ç¤ºå³ä¾§ä¸‰ä¸ªæ¨¡å— */
#analysisPathPage .mindmap-container {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 15px 0;
  padding: 15px;
  background-color: #f7f9fa;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

#analysisPathPage .mindmap-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding: 10px;
  min-width: 100px;
  border-radius: 4px;
  margin: 0 3px;
  text-align: center;
  position: relative;
  align-self: center;
}

#analysisPathPage .mindmap-item .icon {
  font-size: 18px;
  margin-bottom: 5px;
  color: #3498db;
}

#analysisPathPage .mindmap-item .text {
  font-weight: bold;
  color: #333;
  font-size: 12px;
  margin-bottom: 8px;
}

#analysisPathPage .mindmap-equals, #analysisPathPage .mindmap-plus {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: bold;
  margin: 0 10px;
  color: #95a5a6;
  align-self: center;
  height: 30px;
}

#analysisPathPage .mindmap-selected-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 3px;
  max-width: 150px;
  overflow-y: auto;
  max-height: 60px;
}

#analysisPathPage .mindmap-tag {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 2px;
  font-size: 10px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

/* æ·»åŠ æ ‡ç­¾ä¸Šçš„ç¼–å·æ ·å¼ */
#analysisPathPage .mindmap-tag .tag-number {
  background-color: #1565c0;
  color: white;
  border-radius: 50%;
  width: 14px;
  height: 14px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 8px;
  margin-right: 2px;
}

#analysisPathPage .mindmap-tag-module {
  background-color: #e3f2fd;
  color: #1565c0;
}

#analysisPathPage .mindmap-tag-knowledge {
  background-color: #fff8e1;
  color: #f57f17;
}

#analysisPathPage .mindmap-tag-strategy {
  background-color: #f1f8e9;
  color: #558b2f;
}

#analysisPathPage .object-tags {
  margin-top: 10px;
}

/* ä¸ºç²˜æ€§ç­‰å¼é¢„ç•™å ä½ç¬¦ */
#equation-placeholder {
  display: none;
  margin: 0;
  padding: 0;
}

#equation-placeholder.active {
  display: block;
}

/* çŸ¥è¯†å’Œç­–ç•¥ç­›é€‰å™¨æ ·å¼ */
.filter-container {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-bottom: 20px;
}

.filter-row {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  align-items: center;
}

.filter-label {
  font-weight: bold;
  color: #666;
  min-width: 80px;
}

.filter-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.filter-chip {
  padding: 5px 10px;
  background-color: #f1f1f1;
  border-radius: 20px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
}

.filter-chip:hover {
  background-color: #e0e0e0;
}

.filter-chip.selected {
  background-color: #3498db;
  color: white;
}

.search-filter {
  position: relative;
  margin-bottom: 15px;
}

.search-filter input {
  padding-left: 35px;
  padding-right: 10px;
  width: 100%;
}

.search-filter i {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #aaa;
  font-size: 14px;
  z-index: 1;
}

.top-recommendations {
  margin-bottom: 20px;
}

.top-recommendations h4 {
  font-size: 15px;
  margin-bottom: 10px;
  color: #666;
}

.see-more-btn {
  color: #3498db;
  background: none;
  border: none;
  font-size: 13px;
  cursor: pointer;
  text-decoration: underline;
  margin-top: 10px;
  display: block;
}

/* æ•´ä½“è¦æ±‚æ­¥éª¤æ ·å¼ */
#requirementSection textarea {
  min-height: 100px;
  margin-bottom: 15px;
}

.knowledge-pill {
  display: inline-block;
  background-color: #fff8e1;
  color: #f57f17;
  padding: 5px 10px;
  border-radius: 20px;
  margin-right: 8px;
  margin-bottom: 8px;
  font-size: 13px;
  cursor: pointer;
}

.knowledge-pill:hover {
  background-color: #ffecb3;
}

.pills-container {
  margin-top: 15px;
}

/* æœç´¢å»ºè®®æ¡†æ ·å¼ */
.search-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background-color: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  z-index: 100;
  max-height: 250px;
  overflow-y: auto;
  display: none;
}

.search-suggestions.active {
  display: block;
}

.suggestion-item {
  padding: 10px 15px;
  border-bottom: 1px solid #eee;
  cursor: pointer;
  transition: background-color 0.2s;
}

.suggestion-item:hover {
  background-color: #f5f5f5;
}

.suggestion-item:last-child {
  border-bottom: none;
}

.suggestion-id {
  color: #999;
  font-size: 12px;
  margin-right: 8px;
}

.suggestion-name {
  font-weight: bold;
}

.suggestion-owner {
  color: #666;
  font-size: 12px;
  margin-left: 8px;
}

/* å¼¹å‡ºå±‚æ ·å¼æ”¹è¿› */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0,0,0,0.5);
  z-index: 1000;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
  display: none;
  backdrop-filter: blur(3px);
}

.modal-overlay.active {
  display: flex;
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.modal-container {
  background-color: white;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  max-width: 900px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  position: relative;
  animation: slideUp 0.3s ease;
}

@keyframes slideUp {
  from { transform: translateY(20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.modal-header {
  padding: 20px 24px;
  border-bottom: 1px solid #eee;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: #f9f9fc;
  border-radius: 12px 12px 0 0;
}

.modal-title {
  font-size: 20px;
  font-weight: bold;
  color: #333;
}

.modal-close {
  background: none;
  border: none;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: #666;
  transition: all 0.2s;
  font-size: 22px;
}

.modal-close:hover {
  background-color: rgba(0,0,0,0.05);
  color: #333;
}

.modal-body {
  padding: 24px;
  flex: 1;
  overflow-y: auto;
}

.modal-footer {
  padding: 16px 24px;
  border-top: 1px solid #eee;
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  background-color: #f9f9fc;
  border-radius: 0 0 12px 12px;
}

.modal-footer .button {
  padding: 10px 18px;
  font-size: 14px;
  border-radius: 6px;
  transition: all 0.2s;
}

.modal-footer .button-danger {
  background-color: #fff;
  color: #e74c3c;
  border: 1px solid #e74c3c;
}

.modal-footer .button-danger:hover {
  background-color: #fdeeec;
}

/* å±‚çº§ç­›é€‰å™¨æ ·å¼æ”¹è¿› */
.hierarchy-filters {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 24px;
  background-color: #f9f9fc;
  padding: 16px;
  border-radius: 8px;
}

.hierarchy-filter {
  flex: 1;
  min-width: 200px;
}

.hierarchy-filter-title {
  font-weight: bold;
  margin-bottom: 8px;
  color: #555;
  font-size: 13px;
}

.hierarchy-filter select {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background-color: white;
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23555' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  cursor: pointer;
  transition: border-color 0.2s;
}

.hierarchy-filter select:hover {
  border-color: #aaa;
}

.hierarchy-filter select:focus {
  border-color: #3498db;
  outline: none;
  box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
}

/* å•çº§ç­›é€‰å™¨æ ·å¼æ”¹è¿› */
.single-filters {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  margin-bottom: 24px;
  background-color: #f0f6fa;
  padding: 16px;
  border-radius: 8px;
}

.single-filter {
  flex: 1;
  min-width: 180px;
}

.single-filter-title {
  font-weight: bold;
  margin-bottom: 8px;
  color: #555;
  font-size: 13px;
}

.single-filter select {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background-color: white;
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23555' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  cursor: pointer;
  transition: border-color 0.2s;
}

.single-filter select:hover {
  border-color: #aaa;
}

.single-filter select:focus {
  border-color: #3498db;
  outline: none;
  box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
}

/* çŸ¥è¯†åˆ—è¡¨æ ·å¼æ”¹è¿› */
.knowledge-list {
  border: 1px solid #eee;
  border-radius: 8px;
  margin-top: 20px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.knowledge-item {
  padding: 15px 18px;
  border-bottom: 1px solid #eee;
  cursor: pointer;
  transition: background-color 0.2s;
  display: flex;
  align-items: center;
  background-color: white;
}

.knowledge-item:hover {
  background-color: #f5f9fc;
}

.knowledge-item:last-child {
  border-bottom: none;
}

.knowledge-checkbox {
  margin-right: 15px;
  width: 18px;
  height: 18px;
  accent-color: #3498db;
}

.knowledge-info {
  flex: 1;
}

.knowledge-title {
  font-weight: bold;
  margin-bottom: 5px;
  color: #333;
}

.knowledge-meta {
  display: flex;
  color: #666;
  font-size: 12px;
  gap: 15px;
  flex-wrap: wrap;
}

.knowledge-id, .knowledge-owner, .knowledge-type {
  display: flex;
  align-items: center;
}

.knowledge-id i, .knowledge-owner i, .knowledge-type i {
  margin-right: 5px;
  font-size: 14px;
  color: #999;
}

/* ç»„ç»‡æ¶æ„é€‰æ‹©å™¨æ ·å¼ */
.org-structure-selector {
  margin-bottom: 20px;
}

.org-tabs {
  display: flex;
  border-bottom: 1px solid #eee;
  margin-bottom: 15px;
}

.org-tab {
  padding: 8px 16px;
  cursor: pointer;
  color: #666;
  font-size: 14px;
  position: relative;
  transition: all 0.2s;
}

.org-tab.active {
  color: #3498db;
  font-weight: bold;
}

.org-tab.active::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 0;
  width: 100%;
  height: 2px;
  background-color: #3498db;
}

.org-content {
  display: none;
  margin-top: 15px;
}

.org-content.active {
  display: block;
  animation: fadeIn 0.3s ease;
}

.org-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

@media (max-width: 1200px) {
  .assistant-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 900px) {
  .assistant-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 767px) {
  #analysisPathPage .tabs {
    flex-wrap: wrap;
  }

  #analysisPathPage .tab {
    flex: 1 0 auto;
    text-align: center;
    padding: 10px 12px;
    font-size: 14px;
  }

  #analysisPathPage .card-grid {
    grid-template-columns: 1fr;
  }

  #analysisPathPage .analysis-path-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
  }

  #analysisPathPage .analysis-path-actions {
    width: 100%;
    justify-content: flex-end;
  }

  #analysisPathPage .two-columns {
    grid-template-columns: 1fr;
  }

  #analysisPathPage .equation-container {
    flex-direction: column;
    padding: 10px;
    align-items: center;
  }

  #analysisPathPage .equation-equals, #analysisPathPage .equation-plus {
    margin: 10px 0;
  }

  #analysisPathPage .equation-item {
    margin-bottom: 10px;
    min-width: 200px;
  }

  #analysisPathPage .mindmap-container {
    flex-direction: column;
    align-items: center;
  }

  #analysisPathPage .mindmap-equals, #analysisPathPage .mindmap-plus {
    margin: 5px 0;
  }

  #analysisPathPage .mindmap-item {
    margin-bottom: 10px;
    min-width: 150px;
  }
  
  .hierarchy-filters, .single-filters {
    flex-direction: column;
    gap: 15px;
  }
  
  .hierarchy-filter, .single-filter {
    min-width: 100%;
  }
  
  .modal-container {
    max-height: 95vh;
    width: 95%;
  }
}

@media (max-width: 768px) {
  .main-content {
    margin: 10px;
    padding: 15px;
  }

  .assistant-grid {
    grid-template-columns: repeat(1, 1fr);
  }
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

<div class="main-content">
<!-- ç©ºç™½é¡µé¢ï¼ˆè¯¥åŠŸèƒ½é¡µé¢æ­£åœ¨å»ºè®¾ä¸­ï¼‰ -->
<div class="content-page" id="page-empty">
<div class="empty-placeholder">
<i class="fas fa-tools"></i>
<p>è¯¥åŠŸèƒ½é¡µé¢æ­£åœ¨å»ºè®¾ä¸­...</p>
</div>
</div>

<!-- åˆ†ææ€è·¯é¡µé¢ -->
<div class="content-page active" id="page-analysisPath">
<div id="analysisPathPage">
<div class="container">
<!-- ç®¡ç†é¡µé¢ -->
<div class="page active" id="managePage">
<header>
<h1>åˆ†ææ€è·¯é…ç½®ä¸ç®¡ç†</h1>
<button class="button button-primary" id="newAnalysisPath">+ æ–°å»ºåˆ†ææ€è·¯</button>
</header>

<div class="tab-container">
<div class="tabs">
<div class="tab active" data-tab="allPaths">å…¨éƒ¨åˆ†ææ€è·¯</div>
<div class="tab" data-tab="byObjects">æŒ‰åˆ†æå¯¹è±¡æŸ¥çœ‹</div>
</div>

<div class="tab-content active" id="allPaths">
<input type="text" class="search-bar" placeholder="æœç´¢åˆ†ææ€è·¯...">

<div class="analysis-path-list">
<div class="analysis-path-item">
<div class="analysis-path-header">
<div class="analysis-path-title">å­£åº¦ä¸šç»©åˆ†ææ€è·¯</div>
<div class="analysis-path-actions">
<button class="button button-primary edit-path">ç¼–è¾‘</button>
<button class="button button-danger">åˆ é™¤</button>
<button class="button button-preview">é¢„è§ˆ</button>
</div>
</div>

<!-- ä¿®æ”¹åçš„æ€ç»´å¯¼å›¾ï¼Œç§»é™¤äº†å·¦ä¾§éƒ¨åˆ†å’Œç­‰å· -->
<div class="mindmap-container">
<div class="mindmap-item">
<div class="icon">ğŸ“Š</div>
<div class="text">åˆ†ææ¨¡å—</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-module"><span class="tag-number">1</span>ä¸šç»©</div>
<div class="mindmap-tag mindmap-tag-module"><span class="tag-number">2</span>æˆ¿æº</div>
</div>
</div>
<div class="mindmap-plus">+</div>
<div class="mindmap-item">
<div class="icon">ğŸ§ </div>
<div class="text">ä¸šåŠ¡çŸ¥è¯†</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†1</div>
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†2</div>
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†3</div>
</div>
</div>
<div class="mindmap-plus">+</div>
<div class="mindmap-item">
<div class="icon">ğŸ“</div>
<div class="text">ç®¡ç†ç­–ç•¥</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-strategy">ç­–ç•¥1</div>
<div class="mindmap-tag mindmap-tag-strategy">ç­–ç•¥3</div>
</div>
</div>
</div>

<div class="object-tags">
<span class="tag tag-object">åˆ†æå¯¹è±¡: é—¨åº—</span>
<span class="tag tag-object">åˆ†æå¯¹è±¡: å¤§åŒº</span>
</div>
</div>

<div class="analysis-path-item">
<div class="analysis-path-header">
<div class="analysis-path-title">å®¢æºåˆ†ææ€è·¯</div>
<div class="analysis-path-actions">
<button class="button button-primary edit-path">ç¼–è¾‘</button>
<button class="button button-danger">åˆ é™¤</button>
<button class="button button-preview">é¢„è§ˆ</button>
</div>
</div>

<!-- ä¿®æ”¹åçš„æ€ç»´å¯¼å›¾ -->
<div class="mindmap-container">
<div class="mindmap-item">
<div class="icon">ğŸ“Š</div>
<div class="text">åˆ†ææ¨¡å—</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-module"><span class="tag-number">1</span>å®¢æº</div>
<div class="mindmap-tag mindmap-tag-module"><span class="tag-number">2</span>å¸¦çœ‹</div>
</div>
</div>
<div class="mindmap-plus">+</div>
<div class="mindmap-item">
<div class="icon">ğŸ§ </div>
<div class="text">ä¸šåŠ¡çŸ¥è¯†</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†4</div>
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†5</div>
</div>
</div>
<div class="mindmap-plus">+</div>
<div class="mindmap-item">
<div class="icon">ğŸ“</div>
<div class="text">ç®¡ç†ç­–ç•¥</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-strategy">ç­–ç•¥2</div>
<div class="mindmap-tag mindmap-tag-strategy">ç­–ç•¥4</div>
</div>
</div>
</div>

<div class="object-tags">
<span class="tag tag-object">åˆ†æå¯¹è±¡: CA</span>
<span class="tag tag-object">åˆ†æå¯¹è±¡: åŸå¸‚</span>
</div>
</div>

<div class="analysis-path-item">
<div class="analysis-path-header">
<div class="analysis-path-title">å•†æœºåˆ†ææ€è·¯</div>
<div class="analysis-path-actions">
<button class="button button-primary edit-path">ç¼–è¾‘</button>
<button class="button button-danger">åˆ é™¤</button>
<button class="button button-preview">é¢„è§ˆ</button>
</div>
</div>

<!-- ä¿®æ”¹åçš„æ€ç»´å¯¼å›¾ -->
<div class="mindmap-container">
<div class="mindmap-item">
<div class="icon">ğŸ“Š</div>
<div class="text">åˆ†ææ¨¡å—</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-module"><span class="tag-number">1</span>å•†æœº</div>
</div>
</div>
<div class="mindmap-plus">+</div>
<div class="mindmap-item">
<div class="icon">ğŸ§ </div>
<div class="text">ä¸šåŠ¡çŸ¥è¯†</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†6</div>
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†5</div>
</div>
</div>
<div class="mindmap-plus">+</div>
<div class="mindmap-item">
<div class="icon">ğŸ“</div>
<div class="text">ç®¡ç†ç­–ç•¥</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-strategy">ç­–ç•¥1</div>
<div class="mindmap-tag mindmap-tag-strategy">ç­–ç•¥2</div>
</div>
</div>
</div>

<div class="object-tags">
<span class="tag tag-object">åˆ†æå¯¹è±¡: å¤§éƒ¨</span>
<span class="tag tag-object">åˆ†æå¯¹è±¡: åŒºåŸŸ</span>
</div>
</div>
</div>
</div>

<div class="tab-content" id="byObjects">
<div class="tab-container">
<div class="tabs">
<div class="tab active" data-tab="object1">é—¨åº—</div>
<div class="tab" data-tab="object2">CA</div>
<div class="tab" data-tab="object3">å¤§åŒº</div>
<div class="tab" data-tab="object4">å¤§éƒ¨</div>
<div class="tab" data-tab="object5">åŸå¸‚</div>
<div class="tab" data-tab="object6">åŒºåŸŸ</div>
<div class="tab" data-tab="object7">å…¨å›½</div>
</div>

<div class="tab-content active" id="object1">
<div class="analysis-path-item">
<div class="analysis-path-header">
<div class="analysis-path-title">å­£åº¦ä¸šç»©åˆ†ææ€è·¯</div>
<div class="analysis-path-actions">
<button class="button button-primary edit-path">ç¼–è¾‘</button>
</div>
</div>

<!-- ä¿®æ”¹åçš„æ€ç»´å¯¼å›¾ -->
<div class="mindmap-container">
<div class="mindmap-item">
<div class="icon">ğŸ“Š</div>
<div class="text">åˆ†ææ¨¡å—</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-module"><span class="tag-number">1</span>ä¸šç»©</div>
<div class="mindmap-tag mindmap-tag-module"><span class="tag-number">2</span>æˆ¿æº</div>
</div>
</div>
<div class="mindmap-plus">+</div>
<div class="mindmap-item">
<div class="icon">ğŸ§ </div>
<div class="text">ä¸šåŠ¡çŸ¥è¯†</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†1</div>
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†2</div>
<div class="mindmap-tag mindmap-tag-knowledge">ä¸šåŠ¡çŸ¥è¯†3</div>
</div>
</div>
<div class="mindmap-plus">+</div>
<div class="mindmap-item">
<div class="icon">ğŸ“</div>
<div class="text">ç®¡ç†ç­–ç•¥</div>
<div class="mindmap-selected-tags">
<div class="mindmap-tag mindmap-tag-strategy">ç­–ç•¥1</div>
<div class="mindmap-tag mindmap-tag-strategy">ç­–ç•¥3</div>
</div>
</div>
</div>
</div>
</div>

<div class="tab-content" id="object2">
<!-- CAç›¸å…³åˆ†ææ€è·¯ -->
</div>

<div class="tab-content" id="object3">
<!-- å¤§åŒºç›¸å…³åˆ†ææ€è·¯ -->
</div>

<div class="tab-content" id="object4">
<!-- å¤§éƒ¨ç›¸å…³åˆ†ææ€è·¯ -->
</div>

<div class="tab-content" id="object5">
<!-- åŸå¸‚ç›¸å…³åˆ†ææ€è·¯ -->
</div>

<div class="tab-content" id="object6">
<!-- åŒºåŸŸç›¸å…³åˆ†ææ€è·¯ -->
</div>

<div class="tab-content" id="object7">
<!-- å…¨å›½ç›¸å…³åˆ†ææ€è·¯ -->
</div>
</div>
</div>
</div>
</div>

<!-- åˆ›å»ºé¡µé¢ -->
<div class="page" id="createPage">
<header>
<div class="breadcrumb">
<a href="#" id="backToManage">åˆ†ææ€è·¯ç®¡ç†</a>
<span class="separator">&gt;</span>
<span id="pageTitle">åˆ›å»ºæ–°åˆ†ææ€è·¯</span>
</div>
<h1 id="formTitle">åˆ›å»ºæ–°åˆ†ææ€è·¯</h1>
</header>

<div class="section-container">
<div class="form-group">
<label for="pathName">åˆ†ææ€è·¯åç§°</label>
<input type="text" id="pathName" placeholder="ä¾‹å¦‚ï¼šå­£åº¦ä¸šç»©åˆ†ææ€è·¯">
</div>

<div class="form-group">
<label for="pathDescription">ç®€çŸ­æè¿°</label>
<textarea id="pathDescription" rows="3" placeholder="ç®€è¦æè¿°æ­¤åˆ†ææ€è·¯çš„ç”¨é€”å’Œä»·å€¼"></textarea>
</div>

<!-- å¥‡å¦™ç­‰å¼æµç¨‹å›¾ -->
<div class="equation-container" id="equation-container">
<div class="equation-content">
<div class="equation-item" id="equationPath">
<div class="icon">ğŸ§©</div>
<div class="text">åˆ†ææ€è·¯</div>
</div>
<div class="equation-equals">=</div>
<div class="equation-item" id="equationModule" onclick="scrollToSection('moduleSection')">
<div class="icon">ğŸ“Š</div>
<div class="text">åˆ†ææ¨¡å—</div>
<div class="equation-selected-tags" id="selectedModuleTags"></div>
</div>
<div class="equation-plus">+</div>
<div class="equation-item" id="equationKnowledge" onclick="scrollToSection('knowledgeSection')">
<div class="icon">ğŸ§ </div>
<div class="text">ä¸šåŠ¡çŸ¥è¯†</div>
<div class="equation-selected-tags" id="selectedKnowledgeTags"></div>
</div>
<div class="equation-plus">+</div>
<div class="equation-item" id="equationStrategy" onclick="scrollToSection('strategySection')">
<div class="icon">ğŸ“</div>
<div class="text">ç®¡ç†ç­–ç•¥</div>
<div class="equation-selected-tags" id="selectedStrategyTags"></div>
</div>
</div>
</div>

<!-- ä¸ºç²˜æ€§ç­‰å¼é¢„ç•™çš„å ä½ç¬¦ -->
<div id="equation-placeholder"></div>
</div>

<div class="section-container" id="moduleSection">
<div class="section-header" id="moduleHeader">
<div class="section-title">
<span class="section-number">1</span>
<h2>é€‰æ‹©åˆ†ææ¨¡å—</h2>
</div>
</div>

<input type="text" class="search-bar" placeholder="æœç´¢åˆ†ææ¨¡å—...">
<div class="card-grid">
<div class="card" onclick="toggleSelection(this, 'metricSet')">
<div class="card-title">ä¸šç»©</div>
<div class="card-description">åŒ…å«ç­¾çº¦é‡‘é¢ã€æˆäº¤å¥—æ•°ç­‰ä¸šç»©ç›¸å…³æŒ‡æ ‡</div>
</div>
<div class="card" onclick="toggleSelection(this, 'metricSet')">
<div class="card-title">æˆ¿æº</div>
<div class="card-description">åŒ…å«æˆ¿æºæ•°é‡ã€æˆ¿æºè´¨é‡ç­‰ç›¸å…³æŒ‡æ ‡</div>
</div>
<div class="card" onclick="toggleSelection(this, 'metricSet')">
<div class="card-title">å®¢æº</div>
<div class="card-description">åŒ…å«å®¢æºæ•°é‡ã€å®¢æºè´¨é‡ç­‰ç›¸å…³æŒ‡æ ‡</div>
</div>
<div class="card" onclick="toggleSelection(this, 'metricSet')">
<div class="card-title">å¸¦çœ‹</div>
<div class="card-description">åŒ…å«å¸¦çœ‹é‡ã€å¸¦çœ‹è½¬åŒ–ç‡ç­‰ç›¸å…³æŒ‡æ ‡</div>
</div>
<div class="card" onclick="toggleSelection(this, 'metricSet')">
<div class="card-title">å•†æœº</div>
<div class="card-description">åŒ…å«å•†æœºæ•°ã€å•†æœºè½¬åŒ–ç‡ç­‰ç›¸å…³æŒ‡æ ‡</div>
</div>
</div>

<div class="selected-items" id="selectedMetrics">
<!-- é€‰ä¸­çš„æŒ‡æ ‡å’ŒæŒ‡æ ‡é›†å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
</div>
</div>

<div class="section-container" id="knowledgeSection">
<div class="section-header" id="knowledgeHeader">
<div class="section-title">
<span class="section-number">2</span>
<h2>é€‰æ‹©ä¸šåŠ¡çŸ¥è¯†</h2>
</div>
</div>

<div id="diagnosisContainer">
<div class="no-datasets-selected" id="noDatasetsMessage1">
è¯·å…ˆåœ¨ç¬¬ä¸€æ­¥ä¸­é€‰æ‹©åˆ†ææ¨¡å—
</div>

<!-- åŠ¨æ€ç”Ÿæˆçš„ä¸šåŠ¡çŸ¥è¯†é€‰æ‹©åŒºåŸŸå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
</div>
</div>

<div class="section-container" id="strategySection">
<div class="section-header" id="strategyHeader">
<div class="section-title">
<span class="section-number">3</span>
<h2>é€‰æ‹©ç®¡ç†ç­–ç•¥</h2>
</div>
</div>

<div id="managementContainer">
<div class="no-datasets-selected" id="noDatasetsMessage2">
è¯·å…ˆåœ¨ç¬¬ä¸€æ­¥ä¸­é€‰æ‹©åˆ†ææ¨¡å—
</div>

<!-- åŠ¨æ€ç”Ÿæˆçš„ç®¡ç†ç­–ç•¥é€‰æ‹©åŒºåŸŸå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
</div>
</div>

<div class="section-container" id="requirementSection">
<div class="section-header" id="requirementHeader">
<div class="section-title">
<span class="section-number">4</span>
<h2>å¡«å†™æ•´ä½“è¦æ±‚</h2>
</div>
</div>

<div class="form-group">
<label for="overallRequirement">æ•´ä½“è¦æ±‚æè¿°</label>
<textarea id="overallRequirement" placeholder="è¯·åœ¨è¿™é‡Œè¾“å…¥åˆ†ææ€è·¯çš„æ•´ä½“è¦æ±‚ï¼Œä¾‹å¦‚ï¼šæ¯æœˆéœ€è¦é‡ç‚¹å…³æ³¨çš„æŒ‡æ ‡å’Œå…³é”®é—®é¢˜..."></textarea>
</div>

<div class="search-filter">
<i class="fas fa-search"></i>
<input type="text" placeholder="æœç´¢ç›¸å…³çŸ¥è¯†..." id="requirementSearch">
<div class="search-suggestions" id="requirementSuggestions"></div>
</div>

<div class="top-recommendations">
<h4>æ¨èçŸ¥è¯†:</h4>
<div class="card-grid">
<div class="card" onclick="addKnowledgeToRequirement(this)">
<div class="card-title">å­£åº¦ä¸šç»©åˆ†ææ¡†æ¶</div>
<div class="card-description">æ¡†æ¶å‹ï¼Œé€‚ç”¨äºå­£åº¦ä¸šç»©åˆ†æåœºæ™¯</div>
</div>
<div class="card" onclick="addKnowledgeToRequirement(this)">
<div class="card-title">ç§Ÿèµå¸‚åœºå‘¨æœŸæ³¢åŠ¨</div>
<div class="card-description">çŸ¥è¯†å‹ï¼Œæˆ¿åœ°äº§ç§Ÿèµå¸‚åœºå‘¨æœŸåˆ†æ</div>
</div>
<div class="card" onclick="addKnowledgeToRequirement(this)">
<div class="card-title">åŒºåŸŸå·®å¼‚åŒ–åˆ†æ</div>
<div class="card-description">æ–¹æ³•å‹ï¼Œä¸åŒåŒºåŸŸçš„ä¸šç»©å·®å¼‚åˆ†æ</div>
</div>
</div>
<button class="see-more-btn" onclick="openKnowledgeModal('requirement')">æŸ¥çœ‹æ›´å¤š...</button>
</div>

<div class="selected-items" id="selectedRequirements">
<!-- é€‰ä¸­çš„æ•´ä½“è¦æ±‚çŸ¥è¯†ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ -->
</div>
</div>

<div class="section-container" id="objectSection">
<div class="section-header" id="objectHeader">
<div class="section-title">
<span class="section-number">5</span>
<h2>é€‰æ‹©åˆ†æå¯¹è±¡</h2>
</div>
</div>

<div class="org-structure-selector">
<div class="org-tabs">
<div class="org-tab active" data-org="beike">è´å£³åŸå¸‚è¿è¥</div>
<div class="org-tab" data-org="decor">æ•´è£…</div>
</div>

<div class="org-content active" id="beikeOrgContent">
<div class="org-chips">
<div class="object-chip" onclick="toggleObject(this, 'beike')">é—¨åº—</div>
<div class="object-chip" onclick="toggleObject(this, 'beike')">CA</div>
<div class="object-chip" onclick="toggleObject(this, 'beike')">å¤§åŒº</div>
<div class="object-chip" onclick="toggleObject(this, 'beike')">å¤§éƒ¨</div>
<div class="object-chip" onclick="toggleObject(this, 'beike')">åŸå¸‚</div>
<div class="object-chip" onclick="toggleObject(this, 'beike')">åŒºåŸŸ</div>
<div class="object-chip" onclick="toggleObject(this, 'beike')">å…¨å›½</div>
</div>
</div>

<div class="org-content" id="decorOrgContent">
<div class="org-chips">
<div class="object-chip" onclick="toggleObject(this, 'decor')">åŸå¸‚åº—</div>
<div class="object-chip" onclick="toggleObject(this, 'decor')">ç»è¥éƒ¨</div>
<div class="object-chip" onclick="toggleObject(this, 'decor')">å¤§åŒº</div>
<div class="object-chip" onclick="toggleObject(this, 'decor')">åŒºåŸŸ</div>
<div class="object-chip" onclick="toggleObject(this, 'decor')">å…¨å›½</div>
</div>
</div>
</div>

</div>

<div class="action-buttons">
<button class="button button-danger" id="cancelButton">å–æ¶ˆ</button>
<button class="button button-success" id="saveButton">ä¿å­˜åˆ†ææ€è·¯</button>
<button class="button button-preview" id="previewButton">é¢„è§ˆ</button>
</div>
</div>
</div>
</div>
</div>

<!-- å¼¹å‡ºå±‚ï¼šçŸ¥è¯†é€‰æ‹© -->
<div class="modal-overlay" id="knowledgeModal">
<div class="modal-container">
<div class="modal-header">
<div class="modal-title">é€‰æ‹©ä¸šåŠ¡çŸ¥è¯†</div>
<button class="modal-close" onclick="closeModal('knowledgeModal')">&times;</button>
</div>
<div class="modal-body">
<div class="search-filter">
<i class="fas fa-search"></i>
<input type="text" placeholder="æœç´¢çŸ¥è¯†..." id="modalSearchInput">
</div>

<div class="hierarchy-filters">
<div class="hierarchy-filter">
<div class="hierarchy-filter-title">ä¸€çº§æ ‡ç­¾</div>
<select id="level1Filter" onchange="updateLevel2Options()">
<option value="">å…¨éƒ¨</option>
<option value="ä¸šåŠ¡åˆ†æ">ä¸šåŠ¡åˆ†æ</option>
<option value="å¸‚åœºç ”ç©¶">å¸‚åœºç ”ç©¶</option>
<option value="ç®¡ç†æ–¹æ³•">ç®¡ç†æ–¹æ³•</option>
</select>
</div>
<div class="hierarchy-filter">
<div class="hierarchy-filter-title">äºŒçº§æ ‡ç­¾</div>
<select id="level2Filter" onchange="updateLevel3Options()">
<option value="">å…¨éƒ¨</option>
</select>
</div>
<div class="hierarchy-filter">
<div class="hierarchy-filter-title">ä¸‰çº§æ ‡ç­¾</div>
<select id="level3Filter" onchange="filterKnowledgeList()">
<option value="">å…¨éƒ¨</option>
</select>
</div>
</div>

<div class="single-filters">
<div class="single-filter">
<div class="single-filter-title">ä¸šåŠ¡çº¿</div>
<select id="businessLineFilter" onchange="filterKnowledgeList()">
<option value="">å…¨éƒ¨</option>
<option value="ç§Ÿèµ">ç§Ÿèµ</option>
<option value="äºŒæ‰‹æˆ¿">äºŒæ‰‹æˆ¿</option>
<option value="æ–°æˆ¿">æ–°æˆ¿</option>
<option value="å…¨ä¸šåŠ¡çº¿">å…¨ä¸šåŠ¡çº¿</option>
</select>
</div>
<div class="single-filter">
<div class="single-filter-title">è´Ÿè´£äºº</div>
<select id="ownerFilter" onchange="filterKnowledgeList()">
<option value="">å…¨éƒ¨</option>
<option value="å¼ ä¸‰">å¼ ä¸‰</option>
<option value="æå››">æå››</option>
<option value="ç‹äº”">ç‹äº”</option>
</select>
</div>
</div>

<div class="knowledge-list" id="knowledgeList">
<!-- çŸ¥è¯†åˆ—è¡¨é¡¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
</div>
</div>
<div class="modal-footer">
<button class="button button-danger" onclick="closeModal('knowledgeModal')">å–æ¶ˆ</button>
<button class="button button-success" onclick="confirmKnowledgeSelection()">ç¡®è®¤é€‰æ‹©</button>
</div>
</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
// åˆ†ææ€è·¯é¡µé¢çš„å†…éƒ¨äº‹ä»¶å¤„ç†
if (document.getElementById('analysisPathPage')) {
// æ–°å»ºåˆ†ææ€è·¯æŒ‰é’®
document.getElementById('newAnalysisPath')?.addEventListener('click', function() {
document.getElementById('formTitle').textContent = 'åˆ›å»ºæ–°åˆ†ææ€è·¯';
document.getElementById('pageTitle').textContent = 'åˆ›å»ºæ–°åˆ†ææ€è·¯';
clearForm();
showPage('createPage', 'managePage');

// å½“é¡µé¢åˆ‡æ¢åˆ°åˆ›å»ºé¡µé¢æ—¶ï¼Œåˆå§‹åŒ–ç²˜æ€§ç­‰å¼
setTimeout(() => {
setupStickyEquation();
}, 100);
});

// è¿”å›ç®¡ç†é¡µé¢æŒ‰é’®
document.getElementById('backToManage')?.addEventListener('click', function(e) {
e.preventDefault();
showPage('managePage', 'createPage');
});

// å–æ¶ˆæŒ‰é’®
document.getElementById('cancelButton')?.addEventListener('click', function() {
showPage('managePage', 'createPage');
});

// ç¼–è¾‘æŒ‰é’®ç‚¹å‡»äº‹ä»¶
document.querySelectorAll('.edit-path').forEach(button => {
button.addEventListener('click', function() {
const item = this.closest('.analysis-path-item');
const title = item.querySelector('.analysis-path-title').textContent;

document.getElementById('formTitle').textContent = 'ç¼–è¾‘åˆ†ææ€è·¯';
document.getElementById('pageTitle').textContent = 'ç¼–è¾‘åˆ†ææ€è·¯';
document.getElementById('pathName').value = title;

// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥åŠ è½½å¯¹åº”åˆ†ææ€è·¯çš„å®Œæ•´æ•°æ®
// ä¸ºæ¼”ç¤ºï¼Œæˆ‘ä»¬æ¨¡æ‹ŸåŠ è½½ä¸€äº›æ•°æ®
simulateLoadPathData(item);

showPage('createPage', 'managePage');

// å½“é¡µé¢åˆ‡æ¢åˆ°ç¼–è¾‘é¡µé¢æ—¶ï¼Œåˆå§‹åŒ–ç²˜æ€§ç­‰å¼
setTimeout(() => {
setupStickyEquation();
}, 100);
});
});

// ä¿å­˜æŒ‰é’®åŠŸèƒ½
document.getElementById('saveButton')?.addEventListener('click', function() {
// æ ¡éªŒå¿…å¡«é¡¹
const pathName = document.getElementById('pathName').value.trim();
if (!pathName) {
alert('è¯·è¾“å…¥åˆ†ææ€è·¯åç§°');
return;
}

// æ ¡éªŒæ˜¯å¦é€‰æ‹©äº†åˆ†æå¯¹è±¡
if (selectedObjects.length === 0) {
alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªåˆ†æå¯¹è±¡');
return;
}

// æ ¡éªŒæ˜¯å¦é€‰æ‹©äº†åˆ†ææ¨¡å—
if (selectedDatasets.length === 0) {
alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªåˆ†ææ¨¡å—');
return;
}

// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥ä¿å­˜è¡¨å•æ•°æ®

// æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
alert('åˆ†ææ€è·¯å·²æˆåŠŸä¿å­˜ï¼');

// è¿”å›ç®¡ç†é¡µé¢
showPage('managePage', 'createPage');
});

// æ ‡ç­¾åˆ‡æ¢äº‹ä»¶
document.querySelectorAll('#analysisPathPage .tabs .tab').forEach(tab => {
tab.addEventListener('click', function() {
const tabId = this.getAttribute('data-tab');
const tabContainer = this.closest('.tab-container');

tabContainer.querySelectorAll('.tab').forEach(t => {
t.classList.remove('active');
});

tabContainer.querySelectorAll('.tab-content').forEach(content => {
content.classList.remove('active');
});

this.classList.add('active');
const contentElement = document.getElementById(tabId);
if (contentElement) {
contentElement.classList.add('active');
}
});
});

// ç»„ç»‡æ¶æ„åˆ‡æ¢äº‹ä»¶
document.querySelectorAll('.org-tab').forEach(tab => {
tab.addEventListener('click', function() {
// ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„æ´»åŠ¨çŠ¶æ€
document.querySelectorAll('.org-tab').forEach(t => {
t.classList.remove('active');
});

// æ·»åŠ å½“å‰æ ‡ç­¾çš„æ´»åŠ¨çŠ¶æ€
this.classList.add('active');

// éšè—æ‰€æœ‰å†…å®¹
document.querySelectorAll('.org-content').forEach(content => {
content.classList.remove('active');
});

// æ˜¾ç¤ºå¯¹åº”çš„å†…å®¹
const orgType = this.getAttribute('data-org');
const contentId = orgType + 'OrgContent';
document.getElementById(contentId).classList.add('active');
});
});

// ä¸ºå¥‡å¦™ç­‰å¼çš„å„é¡¹æ·»åŠ ç‚¹å‡»äº‹ä»¶
document.getElementById('equationModule')?.addEventListener('click', function() {
scrollToSection('moduleSection');
});

document.getElementById('equationKnowledge')?.addEventListener('click', function() {
scrollToSection('knowledgeSection');
});

document.getElementById('equationStrategy')?.addEventListener('click', function() {
scrollToSection('strategySection');
});

// åˆå§‹åŒ–
resetDiagnosisAndManagement();

// åˆå§‹åŒ–æœç´¢æ¡†çš„äº‹ä»¶ç›‘å¬
initializeSearchEvents();

// åˆå§‹åŒ–çŸ¥è¯†æ¨¡æ€æ¡†
initializeKnowledgeModal();
}

// é»˜è®¤æ˜¾ç¤ºåˆ†ææ€è·¯é¡µé¢
showPage('page-analysisPath');

// æ˜¾ç¤ºæŒ‡å®šé¡µé¢
function showPage(showPageId, hidePageId = null) {
if (showPageId === 'createPage' || hidePageId === 'createPage') {
// åœ¨åˆ†ææ€è·¯å†…éƒ¨é¡µé¢åˆ‡æ¢
if (document.getElementById('analysisPathPage')) {
document.querySelectorAll('#analysisPathPage .page').forEach(page => {
page.classList.remove('active');
});
document.getElementById(showPageId).classList.add('active');
}
} else {
// åœ¨ä¸»é¡µé¢é—´åˆ‡æ¢
document.querySelectorAll('.content-page').forEach(page => {
page.classList.remove('active');
});
document.getElementById(showPageId).classList.add('active');
}
}
});

// åˆå§‹åŒ–æœç´¢ç›¸å…³äº‹ä»¶
function initializeSearchEvents() {
// è®¾ç½®æœç´¢æ¡†ç„¦ç‚¹å’Œå¤±ç„¦äº‹ä»¶
const searchInputs = document.querySelectorAll('.search-filter input');
searchInputs.forEach(input => {
// ç„¦ç‚¹äº‹ä»¶
input.addEventListener('focus', function() {
// å¦‚æœæœ‰å€¼ï¼Œæ‰æ˜¾ç¤ºå»ºè®®
if (this.value.trim().length > 0) {
showSuggestions(this, this.id.replace('Search', '').toLowerCase());
}
});

// å¤±ç„¦äº‹ä»¶
input.addEventListener('blur', function() {
// å»¶è¿Ÿéšè—å»ºè®®æ¡†ï¼Œä»¥ä¾¿å¯ä»¥ç‚¹å‡»å»ºè®®
setTimeout(() => {
const suggestionsId = this.id.replace('Search', 'Suggestions');
const suggestionsBox = document.getElementById(suggestionsId);
if (suggestionsBox) {
suggestionsBox.classList.remove('active');
}
}, 200);
});

// é”®ç›˜è¾“å…¥äº‹ä»¶
input.addEventListener('keyup', function() {
const query = this.value.trim();
const type = this.id.replace('Search', '').toLowerCase();
// åªæœ‰å½“è¾“å…¥å€¼å¤§äº0æ—¶æ‰æ˜¾ç¤ºå»ºè®®
if (query.length > 0) {
showSuggestions(this, type);
} else {
const suggestionsId = this.id.replace('Search', 'Suggestions');
const suggestionsBox = document.getElementById(suggestionsId);
if (suggestionsBox) {
suggestionsBox.classList.remove('active');
}
}
});
});
}

// åˆå§‹åŒ–çŸ¥è¯†æ¨¡æ€æ¡†
function initializeKnowledgeModal() {
// è®¾ç½®æ¨¡æ€æ¡†æœç´¢æ¡†çš„äº‹ä»¶
const modalSearchInput = document.getElementById('modalSearchInput');
if (modalSearchInput) {
modalSearchInput.addEventListener('keyup', function() {
filterKnowledgeList();
});
}
}

// æ·»åŠ æ»šåŠ¨æ•ˆæœï¼Œä½¿ç­‰å¼åœ¨é¡µé¢æ»šåŠ¨æ—¶æ‚¬æµ®åœ¨é¡¶éƒ¨å¹¶å±…ä¸­å¯¹é½
function setupStickyEquation() {
const equationContainer = document.getElementById('equation-container');
const placeholder = document.getElementById('equation-placeholder');
const mainContent = document.querySelector('.main-content');
const sectionContainer = document.querySelector('.section-container');

if (!equationContainer || !mainContent || !sectionContainer) return;

// è·å–ä¸»å†…å®¹ç™½è‰²èƒŒæ™¯åŒºåŸŸçš„å®½åº¦
const mainContentWidth = mainContent.offsetWidth;
const sectionContainerWidth = sectionContainer.offsetWidth;
const sectionContainerPadding = parseInt(window.getComputedStyle(sectionContainer).padding);

// è·å–ç­‰å¼å®¹å™¨çš„åŸå§‹å°ºå¯¸å’Œä½ç½®
const originalRect = equationContainer.getBoundingClientRect();
const originalTop = originalRect.top + window.pageYOffset;
const originalHeight = originalRect.height;
let isSticky = false;

// ç§»é™¤æ—§çš„æ»šåŠ¨äº‹ä»¶ç›‘å¬å™¨ä»¥é¿å…é‡å¤ç›‘å¬
window.removeEventListener('scroll', handleScroll);
window.removeEventListener('resize', handleResize);

// å¤„ç†æ»šåŠ¨äº‹ä»¶çš„å‡½æ•°
function handleScroll() {
const scrollY = window.pageYOffset;
const createPage = document.getElementById('createPage');

// ä»…å½“åˆ›å»ºé¡µé¢å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶åº”ç”¨æ‚¬æµ®æ•ˆæœ
if (!createPage || !createPage.classList.contains('active')) return;

if (scrollY > originalTop && !isSticky) {
// è®¾ç½®å ä½ç¬¦ä»¥é˜²æ­¢é¡µé¢è·³åŠ¨
placeholder.style.height = originalHeight + 'px';
placeholder.classList.add('active');

// å›ºå®šç­‰å¼å®¹å™¨å¹¶ä¿æŒå†…å®¹å±…ä¸­
equationContainer.classList.add('sticky');
equationContainer.style.backgroundColor = '#f7f9fa';

// ç¡®ä¿å†…å®¹éƒ¨åˆ†å±…ä¸­ä¸”å®½åº¦ä¸ä¸»å†…å®¹ä¸€è‡´
const equationContent = equationContainer.querySelector('.equation-content');
if (equationContent) {
  // ä½¿ç”¨èŠ‚ç‚¹å®¹å™¨çš„å®½åº¦ï¼Œè¿™æ˜¯ç™½è‰²èƒŒæ™¯éƒ¨åˆ†çš„å®½åº¦
  equationContent.style.maxWidth = sectionContainerWidth + 'px';
  equationContent.style.padding = `0 ${sectionContainerPadding}px`;
}

isSticky = true;
} else if (scrollY <= originalTop && isSticky) {
// å–æ¶ˆå›ºå®š
equationContainer.classList.remove('sticky');
placeholder.classList.remove('active');
equationContainer.style.backgroundColor = '';

// é‡ç½®å†…å®¹éƒ¨åˆ†æ ·å¼
const equationContent = equationContainer.querySelector('.equation-content');
if (equationContent) {
  equationContent.style.maxWidth = '';
  equationContent.style.padding = '';
}

isSticky = false;
}
}

// å¤„ç†çª—å£å¤§å°å˜åŒ–çš„å‡½æ•°
function handleResize() {
// é‡æ–°æµ‹é‡ç™½è‰²èƒŒæ™¯åŒºåŸŸçš„å®½åº¦
const newSectionContainerWidth = document.querySelector('.section-container').offsetWidth;
const newSectionContainerPadding = parseInt(window.getComputedStyle(document.querySelector('.section-container')).padding);

// æ›´æ–°æ‚¬æµ®çŠ¶æ€ä¸‹çš„å®½åº¦
if (isSticky) {
  const equationContent = equationContainer.querySelector('.equation-content');
  if (equationContent) {
    equationContent.style.maxWidth = newSectionContainerWidth + 'px';
    equationContent.style.padding = `0 ${newSectionContainerPadding}px`;
  }
}
}

// æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
window.addEventListener('scroll', handleScroll);
window.addEventListener('resize', handleResize);

// åˆå§‹è§¦å‘ä¸€æ¬¡æ»šåŠ¨å¤„ç†ï¼Œä»¥é˜²é¡µé¢å·²ç»æ»šåŠ¨
handleScroll();
}

// æ˜¾ç¤ºæœç´¢å»ºè®®
function showSuggestions(input, type) {
const query = input.value.trim();
if (query.length < 1) {
const suggestionsId = input.id.replace('Search', 'Suggestions');
document.getElementById(suggestionsId).classList.remove('active');
return;
}

const suggestionsId = input.id.replace('Search', 'Suggestions');
const suggestionsContainer = document.getElementById(suggestionsId);
if (!suggestionsContainer) return;

suggestionsContainer.innerHTML = '';
suggestionsContainer.classList.add('active');

// æ¨¡æ‹Ÿæœç´¢ç»“æœ
const results = [
{ id: 'K001', name: query + 'ç›¸å…³çŸ¥è¯†1', owner: 'å¼ ä¸‰' },
{ id: 'K002', name: query + 'ç›¸å…³çŸ¥è¯†2', owner: 'æå››' },
{ id: 'K003', name: query + 'ç›¸å…³çŸ¥è¯†3', owner: 'ç‹äº”' },
{ id: 'K004', name: query + 'ç›¸å…³çŸ¥è¯†4', owner: 'èµµå…­' }
];

results.forEach(result => {
const item = document.createElement('div');
item.className = 'suggestion-item';
item.innerHTML = `
<span class="suggestion-id">${result.id}</span>
<span class="suggestion-name">${result.name}</span>
<span class="suggestion-owner">è´£ä»»äºº: ${result.owner}</span>
`;
item.addEventListener('click', () => {
selectSuggestion(result, type);
});
suggestionsContainer.appendChild(item);
});
}

// é€‰æ‹©æœç´¢å»ºè®®
function selectSuggestion(result, type) {
if (type === 'requirement') {
// æ·»åŠ åˆ°æ•´ä½“è¦æ±‚
const container = document.getElementById('selectedRequirements');
const item = document.createElement('div');
item.className = 'selected-item';
item.innerHTML = `
<span>${result.name}</span>
<span class="remove" onclick="this.closest('.selected-item').remove()">Ã—</span>
`;
container.appendChild(item);
} else {
// æ·»åŠ åˆ°å…¶ä»–ç±»å‹
const dataset = currentModalDataset;
const containerId = `${dataset}-selected-${type}`;
const container = document.getElementById(containerId);
if (container) {
const item = document.createElement('div');
item.className = 'selected-item';
item.innerHTML = `
<span>${result.name}</span>
<span class="remove" onclick="removeStrategy(this, '${result.name}', '${dataset}', '${type}')">Ã—</span>
`;
container.appendChild(item);

// æ·»åŠ åˆ°å¯¹åº”çš„å­˜å‚¨ç»“æ„
if (type === 'diagnosis') {
if (!selectedKnowledge[dataset]) {
selectedKnowledge[dataset] = [];
}
selectedKnowledge[dataset].push(result.name);
} else if (type === 'management') {
if (!selectedManagementStrategies[dataset]) {
selectedManagementStrategies[dataset] = [];
}
selectedManagementStrategies[dataset].push(result.name);
}

// æ›´æ–°ç­‰å¼ä¸­çš„æ ‡ç­¾
updateEquationTags();
}
}

// éšè—å»ºè®®æ¡†
const suggestionsId = type === 'requirement' ? 'requirementSuggestions' : (currentModalDataset + type + 'Suggestions');
const suggestionsEl = document.getElementById(suggestionsId);
if (suggestionsEl) {
suggestionsEl.classList.remove('active');
}
}

// æ·»åŠ çŸ¥è¯†åˆ°æ•´ä½“è¦æ±‚
function addKnowledgeToRequirement(card) {
const title = card.querySelector('.card-title').textContent;
const container = document.getElementById('selectedRequirements');


// æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
let exists = false;
container.querySelectorAll('.selected-item').forEach(item => {
if (item.textContent.includes(title)) {
exists = true;
}
});

if (!exists) {
const item = document.createElement('div');
item.className = 'selected-item';
item.innerHTML = `${title}<span class="remove" onclick="this.closest('.selected-item').remove()">Ã—</span>`;
container.appendChild(item);
}
}

// æ‰“å¼€çŸ¥è¯†é€‰æ‹©å¼¹çª—
let currentModalType = '';
let currentModalDataset = '';
let selectedModalItems = [];

function openKnowledgeModal(type, dataset) {
currentModalType = type;
currentModalDataset = dataset || '';
selectedModalItems = [];

// æ ¹æ®ç±»å‹è®¾ç½®å¼¹çª—æ ‡é¢˜
const modalTitle = document.querySelector('.modal-title');
if (type === 'diagnosis') {
modalTitle.textContent = 'é€‰æ‹©ä¸šåŠ¡çŸ¥è¯†';
} else if (type === 'management') {
modalTitle.textContent = 'é€‰æ‹©ç®¡ç†ç­–ç•¥';
} else if (type === 'requirement') {
modalTitle.textContent = 'é€‰æ‹©æ•´ä½“è¦æ±‚çŸ¥è¯†';
}

// åŠ è½½çŸ¥è¯†åˆ—è¡¨
loadKnowledgeList();

// é‡ç½®ç­›é€‰å™¨
document.getElementById('level1Filter').value = '';
document.getElementById('level2Filter').innerHTML = '<option value="">å…¨éƒ¨</option>';
document.getElementById('level3Filter').innerHTML = '<option value="">å…¨éƒ¨</option>';
document.getElementById('businessLineFilter').value = '';
document.getElementById('ownerFilter').value = '';
document.getElementById('modalSearchInput').value = '';

// æ˜¾ç¤ºå¼¹çª—
document.getElementById('knowledgeModal').classList.add('active');
}

// å…³é—­å¼¹çª—
function closeModal(modalId) {
document.getElementById(modalId).classList.remove('active');
}

// ç¡®è®¤é€‰æ‹©çŸ¥è¯†
function confirmKnowledgeSelection() {
// è·å–é€‰ä¸­çš„çŸ¥è¯†
const checkboxes = document.querySelectorAll('#knowledgeList .knowledge-checkbox:checked');
if (checkboxes.length === 0) {
alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªçŸ¥è¯†');
return;
}

// æ ¹æ®ä¸åŒç±»å‹å¤„ç†é€‰æ‹©ç»“æœ
if (currentModalType === 'requirement') {
// æ·»åŠ åˆ°æ•´ä½“è¦æ±‚
const container = document.getElementById('selectedRequirements');
checkboxes.forEach(checkbox => {
const item = checkbox.closest('.knowledge-item');
const title = item.querySelector('.knowledge-title').textContent;


// æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
let exists = false;
container.querySelectorAll('.selected-item').forEach(existingItem => {
if (existingItem.textContent.includes(title)) {
exists = true;
}
});

if (!exists) {
const newItem = document.createElement('div');
newItem.className = 'selected-item';
newItem.innerHTML = `${title}<span class="remove" onclick="this.closest('.selected-item').remove()">Ã—</span>`;
container.appendChild(newItem);
}
});
} else {
// æ·»åŠ åˆ°ä¸šåŠ¡çŸ¥è¯†æˆ–ç®¡ç†ç­–ç•¥
const container = document.getElementById(`${currentModalDataset}-selected-${currentModalType}`);
if (container) {
checkboxes.forEach(checkbox => {
const item = checkbox.closest('.knowledge-item');
const title = item.querySelector('.knowledge-title').textContent;


// æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
let exists = false;
container.querySelectorAll('.selected-item').forEach(existingItem => {
if (existingItem.textContent.includes(title)) {
exists = true;
}
});

if (!exists) {
const newItem = document.createElement('div');
newItem.className = 'selected-item';
newItem.innerHTML = `${title}<span class="remove" onclick="removeStrategy(this, '${title}', '${currentModalDataset}', '${currentModalType}')">Ã—</span>`;
container.appendChild(newItem);

// æ·»åŠ åˆ°å¯¹åº”çš„å­˜å‚¨ç»“æ„
if (currentModalType === 'diagnosis') {
if (!selectedKnowledge[currentModalDataset]) {
selectedKnowledge[currentModalDataset] = [];
}
selectedKnowledge[currentModalDataset].push(title);
} else if (currentModalType === 'management') {
if (!selectedManagementStrategies[currentModalDataset]) {
selectedManagementStrategies[currentModalDataset] = [];
}
selectedManagementStrategies[currentModalDataset].push(title);
}
}
});

// æ›´æ–°ç­‰å¼ä¸­çš„æ ‡ç­¾
updateEquationTags();
}
}

// å…³é—­å¼¹çª—
closeModal('knowledgeModal');
}

// åŠ è½½çŸ¥è¯†åˆ—è¡¨
function loadKnowledgeList() {
const container = document.getElementById('knowledgeList');
container.innerHTML = '';

// æ¨¡æ‹ŸçŸ¥è¯†æ•°æ®
const knowledgeItems = [
{ id: 'K001', title: 'ä¸šç»©åŒæ¯”ç¯æ¯”åˆ†æ', owner: 'å¼ ä¸‰', type: 'åˆ†ææ–¹æ³•', level1: 'ä¸šåŠ¡åˆ†æ', level2: 'ä¸šç»©åˆ†æ', level3: 'åŒæ¯”ç¯æ¯”', businessLine: 'å…¨ä¸šåŠ¡çº¿' },
{ id: 'K002', title: 'ä¸šåŠ¡ç»“æ„å æ¯”åˆ†æ', owner: 'æå››', type: 'åˆ†ææ–¹æ³•', level1: 'ä¸šåŠ¡åˆ†æ', level2: 'ä¸šç»©åˆ†æ', level3: 'ç»“æ„åˆ†æ', businessLine: 'ç§Ÿèµ' },
{ id: 'K003', title: 'äººæ•ˆæŒ‡æ ‡åˆ†æ', owner: 'ç‹äº”', type: 'æ•ˆèƒ½åˆ†æ', level1: 'ä¸šåŠ¡åˆ†æ', level2: 'æ•ˆèƒ½åˆ†æ', level3: 'äººæ•ˆåˆ†æ', businessLine: 'äºŒæ‰‹æˆ¿' },
{ id: 'K004', title: 'ç§Ÿèµå¸‚åœºå‘¨æœŸæ³¢åŠ¨', owner: 'èµµå…­', type: 'å¸‚åœºåˆ†æ', level1: 'å¸‚åœºç ”ç©¶', level2: 'å‘¨æœŸåˆ†æ', level3: 'æ³¢åŠ¨è§„å¾‹', businessLine: 'ç§Ÿèµ' },
{ id: 'K005', title: 'æˆ¿æºè´¨é‡è¯„ä¼°', owner: 'å¼ ä¸‰', type: 'è´¨é‡åˆ†æ', level1: 'ä¸šåŠ¡åˆ†æ', level2: 'æˆ¿æºåˆ†æ', level3: 'è´¨é‡è¯„ä¼°', businessLine: 'å…¨ä¸šåŠ¡çº¿' },
{ id: 'K006', title: 'å®¢æºè½¬åŒ–æ¼æ–—', owner: 'æå››', type: 'è½¬åŒ–åˆ†æ', level1: 'ä¸šåŠ¡åˆ†æ', level2: 'å®¢æºåˆ†æ', level3: 'è½¬åŒ–è¿‡ç¨‹', businessLine: 'äºŒæ‰‹æˆ¿' },
{ id: 'K007', title: 'åŒºåŸŸå·®å¼‚åŒ–åˆ†æ', owner: 'ç‹äº”', type: 'åŒºåŸŸåˆ†æ', level1: 'å¸‚åœºç ”ç©¶', level2: 'åŒºåŸŸåˆ†æ', level3: 'å·®å¼‚åŒ–', businessLine: 'å…¨ä¸šåŠ¡çº¿' },
{ id: 'K008', title: 'å›¢é˜Ÿæ¿€åŠ±æ–¹æ¡ˆ', owner: 'èµµå…­', type: 'ç®¡ç†æ–¹æ³•', level1: 'ç®¡ç†æ–¹æ³•', level2: 'å›¢é˜Ÿç®¡ç†', level3: 'æ¿€åŠ±æœºåˆ¶', businessLine: 'å…¨ä¸šåŠ¡çº¿' },
{ id: 'K009', title: 'å¸¦çœ‹è´¨é‡æå‡', owner: 'å¼ ä¸‰', type: 'æå‡æ–¹æ³•', level1: 'ç®¡ç†æ–¹æ³•', level2: 'ä¸šåŠ¡æå‡', level3: 'å¸¦çœ‹ä¼˜åŒ–', businessLine: 'äºŒæ‰‹æˆ¿' },
{ id: 'K010', title: 'å•†æœºå“åº”æ•ˆç‡', owner: 'æå››', type: 'æ•ˆç‡åˆ†æ', level1: 'ä¸šåŠ¡åˆ†æ', level2: 'å•†æœºåˆ†æ', level3: 'å“åº”æ•ˆç‡', businessLine: 'æ–°æˆ¿' }
];

// æ ¹æ®å½“å‰æ¨¡æ€æ¡†ç±»å‹è¿‡æ»¤çŸ¥è¯†
let filteredItems = knowledgeItems;
if (currentModalType === 'diagnosis') {
filteredItems = knowledgeItems.filter(item => 
item.level1 === 'ä¸šåŠ¡åˆ†æ' || item.level1 === 'å¸‚åœºç ”ç©¶'
);
} else if (currentModalType === 'management') {
filteredItems = knowledgeItems.filter(item => 
item.level1 === 'ç®¡ç†æ–¹æ³•' || item.type.includes('æå‡') || item.type.includes('ç­–ç•¥')
);
}

// æ¸²æŸ“çŸ¥è¯†åˆ—è¡¨
filteredItems.forEach(item => {
const element = document.createElement('div');
element.className = 'knowledge-item';
element.innerHTML = `
<input type="checkbox" class="knowledge-checkbox">
<div class="knowledge-info">
<div class="knowledge-title">${item.title}</div>
<div class="knowledge-meta">
<div class="knowledge-id"><i class="fas fa-hashtag"></i>${item.id}</div>
<div class="knowledge-owner"><i class="fas fa-user"></i>${item.owner}</div>
<div class="knowledge-type"><i class="fas fa-tag"></i>${item.type}</div>
</div>
</div>
`;
container.appendChild(element);
});
}

// æ›´æ–°äºŒçº§æ ‡ç­¾é€‰é¡¹
function updateLevel2Options() {
const level1 = document.getElementById('level1Filter').value;
const level2Select = document.getElementById('level2Filter');
level2Select.innerHTML = '<option value="">å…¨éƒ¨</option>';

// æ ¹æ®é€‰ä¸­çš„ä¸€çº§æ ‡ç­¾ç”Ÿæˆå¯¹åº”çš„äºŒçº§æ ‡ç­¾
if (level1 === 'ä¸šåŠ¡åˆ†æ') {
addOption(level2Select, 'ä¸šç»©åˆ†æ');
addOption(level2Select, 'æˆ¿æºåˆ†æ');
addOption(level2Select, 'å®¢æºåˆ†æ');
addOption(level2Select, 'å¸¦çœ‹åˆ†æ');
addOption(level2Select, 'å•†æœºåˆ†æ');
addOption(level2Select, 'æ•ˆèƒ½åˆ†æ');
} else if (level1 === 'å¸‚åœºç ”ç©¶') {
addOption(level2Select, 'å‘¨æœŸåˆ†æ');
addOption(level2Select, 'åŒºåŸŸåˆ†æ');
addOption(level2Select, 'ç«å“åˆ†æ');
addOption(level2Select, 'è¶‹åŠ¿é¢„æµ‹');
} else if (level1 === 'ç®¡ç†æ–¹æ³•') {
addOption(level2Select, 'å›¢é˜Ÿç®¡ç†');
addOption(level2Select, 'ä¸šåŠ¡æå‡');
addOption(level2Select, 'èµ„æºé…ç½®');
addOption(level2Select, 'ç»©æ•ˆç®¡ç†');
}

// æ›´æ–°ä¸‰çº§æ ‡ç­¾
updateLevel3Options();
}

// æ›´æ–°ä¸‰çº§æ ‡ç­¾é€‰é¡¹
function updateLevel3Options() {
const level1 = document.getElementById('level1Filter').value;
const level2 = document.getElementById('level2Filter').value;
const level3Select = document.getElementById('level3Filter');
level3Select.innerHTML = '<option value="">å…¨éƒ¨</option>';

// æ ¹æ®é€‰ä¸­çš„äºŒçº§æ ‡ç­¾ç”Ÿæˆå¯¹åº”çš„ä¸‰çº§æ ‡ç­¾
if (level2 === 'ä¸šç»©åˆ†æ') {
addOption(level3Select, 'åŒæ¯”ç¯æ¯”');
addOption(level3Select, 'ç»“æ„åˆ†æ');
addOption(level3Select, 'é¢„æµ‹åˆ†æ');
} else if (level2 === 'æˆ¿æºåˆ†æ') {
addOption(level3Select, 'è´¨é‡è¯„ä¼°');
addOption(level3Select, 'ç»“æ„åˆ†å¸ƒ');
addOption(level3Select, 'å‘¨è½¬ç‡');
} else if (level2 === 'åŒºåŸŸåˆ†æ') {
addOption(level3Select, 'å·®å¼‚åŒ–');
addOption(level3Select, 'åŒºåŸŸç‰¹å¾');
addOption(level3Select, 'å‘å±•æ½œåŠ›');
} else if (level2 === 'å›¢é˜Ÿç®¡ç†') {
addOption(level3Select, 'æ¿€åŠ±æœºåˆ¶');
addOption(level3Select, 'å›¢é˜Ÿåä½œ');
addOption(level3Select, 'ç»©æ•ˆè€ƒæ ¸');
}

// åº”ç”¨ç­›é€‰
filterKnowledgeList();
}

// æ·»åŠ é€‰é¡¹åˆ°select
function addOption(select, value) {
const option = document.createElement('option');
option.value = value;
option.textContent = value;
select.appendChild(option);
}

// ç­›é€‰çŸ¥è¯†åˆ—è¡¨
function filterKnowledgeList() {
const searchText = document.getElementById('modalSearchInput').value.toLowerCase();
const level1 = document.getElementById('level1Filter').value;
const level2 = document.getElementById('level2Filter').value;
const level3 = document.getElementById('level3Filter').value;
const businessLine = document.getElementById('businessLineFilter').value;
const owner = document.getElementById('ownerFilter').value;

// è·å–æ‰€æœ‰çŸ¥è¯†é¡¹
const items = document.querySelectorAll('#knowledgeList .knowledge-item');

items.forEach(item => {
const title = item.querySelector('.knowledge-title').textContent.toLowerCase();
const ownerText = item.querySelector('.knowledge-owner').textContent.toLowerCase();
const typeText = item.querySelector('.knowledge-type').textContent.toLowerCase();
const id = item.querySelector('.knowledge-id').textContent.toLowerCase();

// æ£€æŸ¥æ˜¯å¦ç¬¦åˆæœç´¢æ¡ä»¶
const matchesSearch = searchText === '' || 
                      title.includes(searchText) || 
                      ownerText.includes(searchText) || 
                      typeText.includes(searchText) || 
                      id.includes(searchText);

// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿˜éœ€è¦æ£€æŸ¥å±‚çº§æ ‡ç­¾å’Œå•çº§ç­›é€‰å™¨
// è¿™é‡Œä»…åšæ¨¡æ‹Ÿï¼Œå®é™…åº”ç”¨éœ€è¦ä»çŸ¥è¯†é¡¹ä¸­è·å–ç›¸å…³æ•°æ®
const matchesFilters = true; // ç®€åŒ–å¤„ç†ï¼Œå®é™…åº”ç”¨ä¸­éœ€è¦æ ¹æ®ç­›é€‰æ¡ä»¶åˆ¤æ–­

if (matchesSearch && matchesFilters) {
item.style.display = '';
} else {
item.style.display = 'none';
}
});
}

// å­˜å‚¨å·²é€‰ä¸­çš„æ•°æ®é›†
let selectedDatasets = [];

// å­˜å‚¨é€‰ä¸­æ•°æ®é›†çš„é¡ºåºå’Œç¼–å·
let datasetOrder = {};

// å­˜å‚¨å·²é€‰ä¸­çš„åˆ†æå¯¹è±¡
let selectedObjects = [];

// å­˜å‚¨å·²é€‰ä¸­çš„ä¸šåŠ¡çŸ¥è¯†ï¼ˆæŒ‰æ•°æ®é›†ï¼‰
let selectedKnowledge = {};

// å­˜å‚¨å·²é€‰ä¸­çš„ç®¡ç†ç­–ç•¥ï¼ˆæŒ‰æ•°æ®é›†ï¼‰
let selectedManagementStrategies = {};

// æ»šåŠ¨åˆ°æŒ‡å®šéƒ¨åˆ†
function scrollToSection(sectionId) {
// ç§»é™¤æ‰€æœ‰é«˜äº®
document.querySelectorAll('#analysisPathPage .equation-item').forEach(item => {
item.classList.remove('active');
});
document.querySelectorAll('#analysisPathPage .section-header').forEach(header => {
header.classList.remove('highlight');
});

// ç»™ç‚¹å‡»çš„ç­‰å¼é¡¹æ·»åŠ é«˜äº®
document.getElementById('equation' + sectionId.charAt(0).toUpperCase() + sectionId.slice(1, -7)).classList.add('active');

// ç»™å¯¹åº”çš„section headeræ·»åŠ é«˜äº®
const headerId = sectionId.replace('Section', 'Header');
document.getElementById(headerId).classList.add('highlight');

// æ»šåŠ¨åˆ°å¯¹åº”éƒ¨åˆ†
const section = document.getElementById(sectionId);
if (section) {
section.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// 2ç§’åç§»é™¤é«˜äº®
setTimeout(() => {
document.getElementById(headerId).classList.remove('highlight');
}, 2000);
}

// æ›´æ–°ç­‰å¼ä¸­çš„æ ‡ç­¾
function updateEquationTags() {
// æ›´æ–°åˆ†ææ¨¡å—æ ‡ç­¾ - æ·»åŠ ç¼–å·
const moduleTagsContainer = document.getElementById('selectedModuleTags');
moduleTagsContainer.innerHTML = '';

// æŒ‰é¡ºåºæ·»åŠ æ ‡ç­¾
selectedDatasets.forEach(module => {
const tag = document.createElement('div');
tag.className = 'equation-tag equation-tag-module';
// åœ¨æ ‡ç­¾å‰é¢æ·»åŠ ç¼–å·
const order = datasetOrder[module];
if (order) {
tag.textContent = `${order}.${module}`;
} else {
tag.textContent = module;
}
moduleTagsContainer.appendChild(tag);
});

// æ›´æ–°ä¸šåŠ¡çŸ¥è¯†æ ‡ç­¾
const knowledgeTagsContainer = document.getElementById('selectedKnowledgeTags');
knowledgeTagsContainer.innerHTML = '';
const allKnowledge = new Set();
Object.values(selectedKnowledge).forEach(knowledgeArray => {
knowledgeArray.forEach(k => allKnowledge.add(k));
});
Array.from(allKnowledge).forEach(knowledge => {
const tag = document.createElement('div');
tag.className = 'equation-tag equation-tag-knowledge';
tag.textContent = knowledge;
knowledgeTagsContainer.appendChild(tag);
});

// æ›´æ–°ç®¡ç†ç­–ç•¥æ ‡ç­¾
const strategyTagsContainer = document.getElementById('selectedStrategyTags');
strategyTagsContainer.innerHTML = '';
const allStrategies = new Set();
Object.values(selectedManagementStrategies).forEach(strategyArray => {
strategyArray.forEach(s => allStrategies.add(s));
});
Array.from(allStrategies).forEach(strategy => {
const tag = document.createElement('div');
tag.className = 'equation-tag equation-tag-strategy';
tag.textContent = strategy;
strategyTagsContainer.appendChild(tag);
});
}

// é‡æ–°å¸ƒå±€å·²é€‰é¡¹ç›®ï¼Œæ·»åŠ ç¼–å·å’Œç®­å¤´
function updateSelectedMetricsLayout() {
const container = document.getElementById('selectedMetrics');
const items = Array.from(container.querySelectorAll('.selected-item'));
  
// æ¸…ç©ºå½“å‰æ˜¾ç¤º
container.innerHTML = '';
  
// é‡ç½®ç¼–å·é¡ºåº
datasetOrder = {};
  
// é‡å»ºå¸¦ç¼–å·çš„é¡¹ç›®å’Œç®­å¤´
for (let i = 0; i < items.length; i++) {
const item = items[i];
    
// åˆ›å»ºæ–°çš„é¡¹ç›®å…ƒç´ 
const newItem = document.createElement('div');
newItem.className = 'selected-item';
    
// æå–æ ‡é¢˜
const content = item.textContent;
const title = content.split(': ')[1].replace('Ã—', '').trim();
    
// æ·»åŠ ç¼–å· - ä»1å¼€å§‹
const number = document.createElement('span');
number.className = 'item-number';
number.textContent = i + 1;
    
// æ›´æ–°æ•°æ®é›†çš„é¡ºåºï¼Œä¿å­˜ç¼–å· - ä»1å¼€å§‹
datasetOrder[title] = i + 1;
    
// ç»„è£…å…ƒç´ 
newItem.appendChild(number);
newItem.innerHTML += `<span>åˆ†ææ¨¡å—: ${title}</span>`;
newItem.innerHTML += `<span class="remove" onclick="removeMetric(this, '${title}', 'metricSet')" >Ã—</span>`;
    
// æ·»åŠ åˆ°å®¹å™¨
container.appendChild(newItem);
    
// å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªï¼Œæ·»åŠ ç®­å¤´
if (i < items.length - 1) {
const arrow = document.createElement('div');
arrow.className = 'item-arrow';
arrow.innerHTML = '<i class="fas fa-long-arrow-alt-right"></i>';
container.appendChild(arrow);
}
}
  
// æ›´æ–°ç­‰å¼ä¸­çš„æ ‡ç­¾
updateEquationTags();
  
// æ›´æ–°ä¸šåŠ¡çŸ¥è¯†å’Œç®¡ç†ç­–ç•¥åŒºåŸŸ - ä»¥ç¡®ä¿ç¼–å·æ­£ç¡®
updateDiagnosisAndManagement();
}

// åˆ†ææ¨¡å—é€‰æ‹©åŠŸèƒ½
function toggleSelection(card, type) {
card.classList.toggle('selected');
const title = card.querySelector('.card-title').textContent;

updateSelectedMetrics(card, type);

if (card.classList.contains('selected')) {
// æ·»åŠ åˆ°é€‰ä¸­çš„æ•°æ®é›†
selectedDatasets.push(title);
} else {
// ä»é€‰ä¸­çš„æ•°æ®é›†ä¸­ç§»é™¤
selectedDatasets = selectedDatasets.filter(set => set !== title);

// ç§»é™¤é¡ºåºå·
delete datasetOrder[title];

// æ¸…é™¤ç›¸å…³çš„ä¸šåŠ¡çŸ¥è¯†å’Œç®¡ç†ç­–ç•¥
delete selectedKnowledge[title];
delete selectedManagementStrategies[title];
}

// æ›´æ–°ä¸šåŠ¡çŸ¥è¯†å’Œç®¡ç†ç­–ç•¥åŒºåŸŸ
updateDiagnosisAndManagement();
}

// æ›´æ–°å·²é€‰ä¸­çš„åˆ†ææ¨¡å—
function updateSelectedMetrics(card, type) {
const container = document.getElementById('selectedMetrics');
const title = card.querySelector('.card-title').textContent;

if (card.classList.contains('selected')) {
// æ·»åŠ åˆ°å·²é€‰é¡¹ç›®
const item = document.createElement('div');
item.className = 'selected-item';
item.innerHTML = `<span>åˆ†ææ¨¡å—: ${title}</span><span class="remove" onclick="removeMetric(this, '${title}', '${type}')">Ã—</span>`;
container.appendChild(item);
// åœ¨æ·»åŠ åç«‹å³æ›´æ–°å¸ƒå±€
updateSelectedMetricsLayout();
} else {
// ä»å·²é€‰é¡¹ç›®ä¸­ç§»é™¤
container.querySelectorAll('.selected-item').forEach(item => {
if (item.textContent.includes(`åˆ†ææ¨¡å—: ${title}`)) {
item.remove();
}
});
// åœ¨ç§»é™¤åç«‹å³æ›´æ–°å¸ƒå±€
updateSelectedMetricsLayout();
}
}

// ç§»é™¤é€‰ä¸­çš„åˆ†ææ¨¡å—
function removeMetric(element, title, type) {
// æ‰¾åˆ°å¯¹åº”çš„å¡ç‰‡å¹¶å–æ¶ˆé€‰ä¸­
document.querySelectorAll('.card').forEach(card => {
if (card.querySelector('.card-title').textContent === title) {
card.classList.remove('selected');

selectedDatasets = selectedDatasets.filter(set => set !== title);

// ç§»é™¤é¡ºåºå·
delete datasetOrder[title];

// æ¸…é™¤ç›¸å…³çš„ä¸šåŠ¡çŸ¥è¯†å’Œç®¡ç†ç­–ç•¥
delete selectedKnowledge[title];
delete selectedManagementStrategies[title];

updateDiagnosisAndManagement();
}
});

// ç§»é™¤å…ƒç´ 
element.closest('.selected-item').remove();

// é‡æ–°å¸ƒå±€å…¶ä½™å…ƒç´ 
updateSelectedMetricsLayout();
}

// æ›´æ–°ä¸šåŠ¡çŸ¥è¯†å’Œç®¡ç†ç­–ç•¥åŒºåŸŸ
function updateDiagnosisAndManagement() {
const diagnosisContainer = document.getElementById('diagnosisContainer');
const managementContainer = document.getElementById('managementContainer');

// å¦‚æœæ²¡æœ‰é€‰ä¸­æ•°æ®é›†ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
if (selectedDatasets.length === 0) {
document.getElementById('noDatasetsMessage1').style.display = 'block';
document.getElementById('noDatasetsMessage2').style.display = 'block';

// æ¸…ç©ºå·²æœ‰å†…å®¹
const diagnosisItems = diagnosisContainer.querySelectorAll('.dataset-strategy-container');
diagnosisItems.forEach(item => item.remove());

const managementItems = managementContainer.querySelectorAll('.dataset-strategy-container');
managementItems.forEach(item => item.remove());

return;
}

// éšè—æç¤ºä¿¡æ¯
document.getElementById('noDatasetsMessage1').style.display = 'none';
document.getElementById('noDatasetsMessage2').style.display = 'none';

// ä¸ºæ¯ä¸ªé€‰ä¸­çš„æ•°æ®é›†åˆ›å»ºä¸šåŠ¡çŸ¥è¯†é€‰æ‹©åŒºåŸŸ
selectedDatasets.forEach(dataset => {
// æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨è¯¥æ•°æ®é›†çš„é…ç½®åŒºåŸŸ
const existingDiagnosis = diagnosisContainer.querySelector(`[data-dataset="${dataset}"]`);
if (!existingDiagnosis) {
// åˆ›å»ºä¸šåŠ¡çŸ¥è¯†é…ç½®åŒºåŸŸï¼Œæ·»åŠ ç¼–å·
const diagnosisElement = createDatasetStrategyElement(dataset, 'diagnosis');
diagnosisContainer.appendChild(diagnosisElement);
}

// æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨è¯¥æ•°æ®é›†çš„ç®¡ç†ç­–ç•¥é…ç½®åŒºåŸŸ
const existingManagement = managementContainer.querySelector(`[data-dataset="${dataset}"]`);
if (!existingManagement) {
// åˆ›å»ºç®¡ç†ç­–ç•¥é…ç½®åŒºåŸŸï¼Œæ·»åŠ ç¼–å·
const managementElement = createDatasetStrategyElement(dataset, 'management');
managementContainer.appendChild(managementElement);
}
});

// ç§»é™¤ä¸å†éœ€è¦çš„é…ç½®åŒºåŸŸ
diagnosisContainer.querySelectorAll('.dataset-strategy-container').forEach(item => {
const datasetName = item.getAttribute('data-dataset');
if (!selectedDatasets.includes(datasetName)) {
item.remove();
}
});

managementContainer.querySelectorAll('.dataset-strategy-container').forEach(item => {
const datasetName = item.getAttribute('data-dataset');
if (!selectedDatasets.includes(datasetName)) {
item.remove();
}
});
}

// åˆ›å»ºæ•°æ®é›†ç­–ç•¥é€‰æ‹©å…ƒç´ ï¼Œæ·»åŠ ç¼–å·å’Œç­›é€‰å™¨
function createDatasetStrategyElement(dataset, type) {
const container = document.createElement('div');
container.className = 'dataset-strategy-container';
container.setAttribute('data-dataset', dataset);

const header = document.createElement('div');
header.className = 'dataset-header';

// è·å–æ•°æ®é›†ç¼–å· - ä½¿ç”¨æ­£ç¡®çš„åºå·
const datasetNum = datasetOrder[dataset] || 1;

const title = document.createElement('div');
title.className = 'dataset-title';
title.innerHTML = `ä¸º <span class="item-number">${datasetNum}</span> ${dataset} åˆ†ææ¨¡å—é€‰æ‹©${type === 'diagnosis' ? 'ä¸šåŠ¡çŸ¥è¯†' : 'ç®¡ç†ç­–ç•¥'}`;

header.appendChild(title);
container.appendChild(header);

// æ·»åŠ æœç´¢æ¡†
const searchFilter = document.createElement('div');
searchFilter.className = 'search-filter';
searchFilter.innerHTML = `
<i class="fas fa-search"></i>
<input type="text" placeholder="æœç´¢${type === 'diagnosis' ? 'ä¸šåŠ¡çŸ¥è¯†' : 'ç®¡ç†ç­–ç•¥'}..." id="${dataset}${type}Search">
<div class="search-suggestions" id="${dataset}${type}Suggestions"></div>
`;
container.appendChild(searchFilter);

// æ·»åŠ æœç´¢æ¡†äº‹ä»¶ç›‘å¬
setTimeout(() => {
const searchInput = document.getElementById(`${dataset}${type}Search`);
if (searchInput) {
searchInput.addEventListener('focus', function() {
if (this.value.trim().length > 0) {
showSuggestions(this, type);
}
});

searchInput.addEventListener('blur', function() {
setTimeout(() => {
const suggestionsId = this.id.replace('Search', 'Suggestions');
const suggestionsBox = document.getElementById(suggestionsId);
if (suggestionsBox) {
suggestionsBox.classList.remove('active');
}
}, 200);
});

searchInput.addEventListener('keyup', function() {
const query = this.value.trim();
if (query.length > 0) {
showSuggestions(this, type);
} else {
const suggestionsId = this.id.replace('Search', 'Suggestions');
const suggestionsBox = document.getElementById(suggestionsId);
if (suggestionsBox) {
suggestionsBox.classList.remove('active');
}
}
});
}
}, 0);

// æ·»åŠ æ¨èçš„å‰ä¸‰ä¸ªé€‰é¡¹
const recommendationsContainer = document.createElement('div');
recommendationsContainer.className = 'top-recommendations';

// ç”Ÿæˆä¸åŒçš„æ¨èå†…å®¹
let recommendedItems = [];
if (type === 'diagnosis') {
  if (dataset === 'ä¸šç»©') {
    recommendedItems = ['ä¸šç»©åŒæ¯”ç¯æ¯”åˆ†æ', 'ä¸šåŠ¡ç»“æ„å æ¯”åˆ†æ', 'äººæ•ˆæŒ‡æ ‡åˆ†æ'];
  } else if (dataset === 'æˆ¿æº') {
    recommendedItems = ['æˆ¿æºè´¨é‡è¯„ä¼°', 'æˆ¿æºç»“æ„åˆ†æ', 'ä¸Šæ¶æ—¶é—´ä¸æˆäº¤ç‡'];
  } else if (dataset === 'å®¢æº') {
    recommendedItems = ['å®¢æºè½¬åŒ–æ¼æ–—', 'å®¢æºè´¨é‡åˆ†çº§', 'è´­ä¹°æ„å‘åº¦è¯„ä¼°'];
  } else if (dataset === 'å¸¦çœ‹') {
    recommendedItems = ['å¸¦çœ‹è‡³æˆäº¤è½¬åŒ–ç‡', 'å¸¦çœ‹é¢‘æ¬¡ä¸æˆäº¤å…³ç³»', 'å¸¦çœ‹å®¢æˆ·æ»¡æ„åº¦'];
  } else if (dataset === 'å•†æœº') {
    recommendedItems = ['å•†æœºåˆ†çº§ç³»ç»Ÿ', 'å•†æœºå“åº”æ—¶æ•ˆ', 'å•†æœºæ¥æºåˆ†å¸ƒ'];
  }
} else {
  if (dataset === 'ä¸šç»©') {
    recommendedItems = ['ä¸šç»©æå‡ç­–ç•¥', 'å›¢é˜Ÿæ¿€åŠ±æ–¹æ¡ˆ', 'å¢é•¿ç“¶é¢ˆçªç ´'];
  } else if (dataset === 'æˆ¿æº') {
    recommendedItems = ['æˆ¿æºè´¨é‡æå‡', 'ç‹¬å®¶å§”æ‰˜ç­–ç•¥', 'æˆ¿æºç»“æ„ä¼˜åŒ–'];
  } else if (dataset === 'å®¢æº') {
    recommendedItems = ['é«˜è´¨å®¢æºè·å–', 'å®¢æˆ·åˆ†çº§è·Ÿè¿›', 'å®¢æˆ·è½¬åŒ–æå‡'];
  } else if (dataset === 'å¸¦çœ‹') {
    recommendedItems = ['å¸¦çœ‹è´¨é‡æå‡', 'å¸¦çœ‹æµç¨‹ä¼˜åŒ–', 'å¸¦çœ‹ä½“éªŒæå‡'];
  } else if (dataset === 'å•†æœº') {
    recommendedItems = ['å•†æœºç­›é€‰ç­–ç•¥', 'å•†æœºå“åº”æ•ˆç‡', 'å•†æœºè½¬åŒ–ç­–ç•¥'];
  }
}

recommendationsContainer.innerHTML = `<h4>æ¨èçš„${type === 'diagnosis' ? 'ä¸šåŠ¡çŸ¥è¯†' : 'ç®¡ç†ç­–ç•¥'}</h4>`;

// åˆ›å»ºæ¨èé¡¹ç›®å¡ç‰‡å®¹å™¨
const recommendedCards = document.createElement('div');
recommendedCards.className = 'card-grid';

// æ·»åŠ æ¨èçš„ä¸‰ä¸ªå¡ç‰‡
recommendedItems.forEach(item => {
  const card = document.createElement('div');
  card.className = 'card';
  card.setAttribute('onclick', `toggleStrategySelection(this, '${dataset}', '${type}')`);
  
  card.innerHTML = `
    <div class="card-title">${item}</div>
    <div class="card-description">é’ˆå¯¹${dataset}çš„${type === 'diagnosis' ? 'åˆ†æçŸ¥è¯†' : 'ç®¡ç†æ–¹æ³•'}</div>
  `;
  
  recommendedCards.appendChild(card);
});

recommendationsContainer.appendChild(recommendedCards);

// æ·»åŠ æŸ¥çœ‹æ›´å¤šæŒ‰é’®
const seeMoreButton = document.createElement('button');
seeMoreButton.className = 'see-more-btn';
seeMoreButton.innerHTML = 'æŸ¥çœ‹æ›´å¤š...';
seeMoreButton.setAttribute('onclick', `openKnowledgeModal('${type}', '${dataset}')`);
recommendationsContainer.appendChild(seeMoreButton);

container.appendChild(recommendationsContainer);

// æ·»åŠ å·²é€‰é¡¹ç›®å®¹å™¨
const selectedItemsContainer = document.createElement('div');
selectedItemsContainer.className = 'selected-items';
selectedItemsContainer.id = `${dataset}-selected-${type}`;
container.appendChild(selectedItemsContainer);

return container;
}

// ä¸šåŠ¡çŸ¥è¯†/ç®¡ç†ç­–ç•¥é€‰æ‹©åˆ‡æ¢
function toggleStrategySelection(card, dataset, type) {
card.classList.toggle('selected');

const title = card.querySelector('.card-title').textContent;
const containerId = `${dataset}-selected-${type}`;
const container = document.getElementById(containerId);

// åˆå§‹åŒ–æ•°æ®ç»“æ„ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
if (type === 'diagnosis') {
if (!selectedKnowledge[dataset]) {
selectedKnowledge[dataset] = [];
}
} else {
if (!selectedManagementStrategies[dataset]) {
selectedManagementStrategies[dataset] = [];
}
}

if (card.classList.contains('selected')) {
// æ·»åŠ åˆ°å·²é€‰é¡¹ç›®
const item = document.createElement('div');
item.className = 'selected-item';
item.innerHTML = `${title}<span class="remove" onclick="removeStrategy(this, '${title}', '${dataset}', '${type}')">Ã—</span>`;
container.appendChild(item);

// æ·»åŠ åˆ°å¯¹åº”çš„å­˜å‚¨ç»“æ„
if (type === 'diagnosis') {
selectedKnowledge[dataset].push(title);
} else {
selectedManagementStrategies[dataset].push(title);
}
} else {
// ä»å·²é€‰é¡¹ç›®ä¸­ç§»é™¤
container.querySelectorAll('.selected-item').forEach(item => {
if (item.textContent.includes(title)) {
item.remove();
}
});

// ä»å­˜å‚¨ç»“æ„ä¸­ç§»é™¤
if (type === 'diagnosis') {
selectedKnowledge[dataset] = selectedKnowledge[dataset].filter(k => k !== title);
} else {
selectedManagementStrategies[dataset] = selectedManagementStrategies[dataset].filter(s => s !== title);
}
}

// æ›´æ–°ç­‰å¼ä¸­çš„æ ‡ç­¾
updateEquationTags();
}

// ç§»é™¤é€‰ä¸­çš„ç­–ç•¥
function removeStrategy(element, title, dataset, type) {
// æ‰¾åˆ°å¯¹åº”çš„å¡ç‰‡å¹¶å–æ¶ˆé€‰ä¸­
const container = document.querySelector(`[data-dataset="${dataset}"]`);
container.querySelectorAll('.card').forEach(card => {
if (card.querySelector('.card-title').textContent === title) {
card.classList.remove('selected');
}
});

// ä»å­˜å‚¨ç»“æ„ä¸­ç§»é™¤
if (type === 'diagnosis') {
if (selectedKnowledge[dataset]) {
selectedKnowledge[dataset] = selectedKnowledge[dataset].filter(k => k !== title);
}
} else {
if (selectedManagementStrategies[dataset]) {
selectedManagementStrategies[dataset] = selectedManagementStrategies[dataset].filter(s => s !== title);
}
}

// ç§»é™¤å…ƒç´ 
element.closest('.selected-item').remove();

// æ›´æ–°ç­‰å¼ä¸­çš„æ ‡ç­¾
updateEquationTags();
}

// åˆ†æå¯¹è±¡é€‰æ‹©åˆ‡æ¢
function toggleObject(element, orgType) {
element.classList.toggle('selected');
const objectName = element.textContent;
const compoundName = `${orgType}:${objectName}`;

if (element.classList.contains('selected')) {
// æ·»åŠ åˆ°é€‰ä¸­çš„åˆ†æå¯¹è±¡
if (!selectedObjects.includes(compoundName)) {
selectedObjects.push(compoundName);
}
} else {
// ä»é€‰ä¸­çš„åˆ†æå¯¹è±¡ä¸­ç§»é™¤
selectedObjects = selectedObjects.filter(obj => obj !== compoundName);
}
}

// æ¨¡æ‹ŸåŠ è½½åˆ†ææ€è·¯æ•°æ®
function simulateLoadPathData(item) {
// æ¸…ç©ºç°æœ‰é€‰æ‹©
clearForm();

// è®¾ç½®åˆ†æå¯¹è±¡
const objectTags = item.querySelectorAll('.tag.tag-object');
objectTags.forEach(tag => {
const objectName = tag.textContent.replace('åˆ†æå¯¹è±¡: ', '');
// é»˜è®¤æ·»åŠ åˆ°è´å£³åŸå¸‚è¿è¥ç±»åˆ«
document.querySelectorAll('#beikeOrgContent .object-chip').forEach(chip => {
if (chip.textContent === objectName) {
chip.classList.add('selected');
selectedObjects.push(`beike:${objectName}`);
}
});
});

// è·å–æ‰€æœ‰æ¨¡å—æ ‡ç­¾
const moduleTags = item.querySelectorAll('.mindmap-tag-module');
moduleTags.forEach((tag, index) => {
// æå–ä¸åŒ…å«ç¼–å·çš„æ¨¡å—å
const tagText = tag.textContent;
const moduleName = tagText.replace(/^\d+\./, '').trim();
// æ¨¡æ‹Ÿç‚¹å‡»å¯¹åº”çš„å¡ç‰‡
document.querySelectorAll('.card').forEach(card => {
if (card.querySelector('.card-title').textContent === moduleName) {
toggleSelection(card, 'metricSet');
}
});
});

// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥åŠ è½½å…³è”çš„ä¸šåŠ¡çŸ¥è¯†ã€ç®¡ç†ç­–ç•¥å’Œæ•´ä½“è¦æ±‚æ•°æ®
// ä¸ºæ¼”ç¤ºï¼Œæ¨¡æ‹Ÿæ·»åŠ ä¸€äº›æ•´ä½“è¦æ±‚
document.getElementById('overallRequirement').value = "æ¯æœˆé‡ç‚¹å…³æ³¨ä¸šç»©æŒ‡æ ‡çš„æ³¢åŠ¨è¶‹åŠ¿ï¼Œç‰¹åˆ«æ˜¯ä¸ä¸Šå­£åº¦ç›¸æ¯”çš„å˜åŒ–ã€‚å…³æ³¨å¼‚å¸¸æ•°æ®å¹¶è¿›è¡Œæ·±å…¥åˆ†æã€‚";
addKnowledgeToRequirement(document.querySelector('.card-grid .card'));
}

// æ¸…ç©ºè¡¨å•
function clearForm() {
document.getElementById('pathName').value = '';
document.getElementById('pathDescription').value = '';
document.getElementById('overallRequirement').value = '';

// æ¸…é™¤æ‰€æœ‰åˆ†æå¯¹è±¡é€‰æ‹©
document.querySelectorAll('.object-chip.selected').forEach(obj => {
obj.classList.remove('selected');
});
selectedObjects = [];

// æ¸…é™¤æ‰€æœ‰åˆ†ææ¨¡å—é€‰æ‹©
document.querySelectorAll('.card.selected').forEach(card => {
card.classList.remove('selected');
});
document.getElementById('selectedMetrics').innerHTML = '';

// é‡ç½®æ•°æ®é›†åˆ—è¡¨
selectedDatasets = [];
datasetOrder = {};

// é‡ç½®ä¸šåŠ¡çŸ¥è¯†å’Œç®¡ç†ç­–ç•¥
selectedKnowledge = {};
selectedManagementStrategies = {};

// é‡ç½®æ•´ä½“è¦æ±‚
document.getElementById('selectedRequirements').innerHTML = '';

// é‡ç½®ä¸šåŠ¡çŸ¥è¯†å’Œç®¡ç†ç­–ç•¥åŒºåŸŸ
resetDiagnosisAndManagement();

// æ¸…é™¤å¥‡å¦™ç­‰å¼é«˜äº®
document.querySelectorAll('.equation-item').forEach(item => {
item.classList.remove('active');
});

// æ¸…ç©ºç­‰å¼ä¸­çš„æ ‡ç­¾
document.getElementById('selectedModuleTags').innerHTML = '';
document.getElementById('selectedKnowledgeTags').innerHTML = '';
document.getElementById('selectedStrategyTags').innerHTML = '';
}

// é‡ç½®ä¸šåŠ¡çŸ¥è¯†å’Œç®¡ç†ç­–ç•¥åŒºåŸŸ
function resetDiagnosisAndManagement() {
if (!document.getElementById('noDatasetsMessage1')) return;

// æ˜¾ç¤ºæç¤ºä¿¡æ¯
document.getElementById('noDatasetsMessage1').style.display = 'block';
document.getElementById('noDatasetsMessage2').style.display = 'block';

// æ¸…ç©ºå·²æœ‰å†…å®¹
document.getElementById('diagnosisContainer').querySelectorAll('.dataset-strategy-container').forEach(item => {
item.remove();
});

document.getElementById('managementContainer').querySelectorAll('.dataset-strategy-container').forEach(item => {
item.remove();
});
}
</script>
</body>
</html>
